{"version":3,"sources":["../../../packages/theme-shared/extensions/src/lib/adapters/date-time.adapter.ts","../../../node_modules/tslib/tslib.es6.js","../../../packages/theme-shared/extensions/src/lib/adapters/date.adapter.ts","../../../packages/theme-shared/extensions/src/lib/adapters/time.adapter.ts","../../../packages/theme-shared/extensions/src/lib/utils/factory.util.ts","../../../packages/theme-shared/extensions/src/lib/components/date-time-picker/date-time-picker.component.ts","../../../packages/theme-shared/extensions/src/lib/components/extensible-form/extensible-form-prop.component.ts","../../../packages/theme-shared/extensions/src/lib/constants/extra-properties.ts","../../../packages/theme-shared/extensions/src/lib/models/actions.ts","../../../packages/theme-shared/extensions/src/lib/models/entity-actions.ts","../../../packages/theme-shared/extensions/src/lib/models/props.ts","../../../packages/theme-shared/extensions/src/lib/models/entity-props.ts","../../../packages/theme-shared/extensions/src/lib/models/form-props.ts","../../../packages/theme-shared/extensions/src/lib/models/toolbar-actions.ts","../../../packages/theme-shared/extensions/src/lib/services/extensions.service.ts","../../../packages/theme-shared/extensions/src/lib/tokens/extensions.token.ts","../../../packages/theme-shared/extensions/src/lib/components/extensible-form/extensible-form.component.ts","../../../packages/theme-shared/extensions/src/lib/components/extensible-table/extensible-table.component.ts","../../../packages/theme-shared/extensions/src/lib/components/abstract-actions/abstract-actions.component.ts","../../../packages/theme-shared/extensions/src/lib/components/grid-actions/grid-actions.component.ts","../../../packages/theme-shared/extensions/src/lib/components/page-toolbar/page-toolbar.component.ts","../../../packages/theme-shared/extensions/src/lib/directives/disabled.directive.ts","../../../packages/theme-shared/extensions/src/lib/directives/prop-data.directive.ts","../../../packages/theme-shared/extensions/src/lib/ui-extensions.module.ts","../../../packages/theme-shared/extensions/src/lib/utils/props.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/enum.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/state.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/form-props.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/localization.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/validation.util.ts","../../../packages/theme-shared/extensions/src/lib/utils/actions.util.ts"],"names":["DateTimeAdapter","prototype","fromModel","value","date","Date","isNaN","this","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minute","getMinutes","second","getSeconds","toModel","now","Object","assign","getUTCFullYear","toISOString","Injectable","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__extends","__","constructor","create","__read","o","n","m","Symbol","iterator","r","e","i","ar","next","done","push","error","__spread","arguments","length","concat","DateAdapter","_super","formatDate","NgbDateAdapter","TimeAdapter","test","String","isTimeStr","bind","apply","split","map","Number","NgbTimeAdapter","selfFactory","dependency","DateTimePickerComponent","cdRef","setDate","datestr","writeValue","setTime","time","Component","args","exportAs","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","viewProviders","provide","ControlContainer","useFactory","ɵ0","deps","Optional","SkipSelf","useClass","ChangeDetectorRef","Input","ViewChild","NgbInputDatepicker","NgbTimepicker","ExtensibleFormPropComponent","track","options$","of","validators","defineProperty","some","validator","Validators","required","getComponent","prop","options","type","getType","ngOnChanges","_a","currentValue","readonly","disabled","data","ɵ0$1","TrackByService","EXTRA_PROPERTIES_KEY","ActionList","LinkedList","ActionData","getInjected","index","record","permission","visible","action","_","ActionsFactory","contributorCallbacks","get","name","_ctor","Actions","callbackList","actionList","forEach","callback","addContributor","contributeCallback","clearContributors","pop","EntityActionList","EntityActions","_this","EntityActionsFactory","EntityAction","text","icon","createMany","arrayOfOptions","Action","PropList","PropData","displayName","isExtra","PropsFactory","Props","propList","EntityPropList","EntityProps","EntityPropsFactory","EntityProp","columnWidth","sortable","valueResolver","Prop","FormPropList","FormProps","CreateFormPropsFactory","EditFormPropsFactory","FormProp","asyncValidators","autocomplete","id","defaultValue","indexOf","isFalsyValue","FormPropData","injector","ToolbarActionList","ToolbarActions","ToolbarActionsFactory","ToolbarAction","ToolbarComponent","component","entityActions","toolbarActions","entityProps","createFormProps","editFormProps","providedIn","EXTENSIONS_IDENTIFIER","InjectionToken","EXTENSIONS_ACTION_TYPE","EXTENSIONS_ACTION_DATA","EXTENSIONS_ACTION_CALLBACK","ExtensibleFormComponent","container","extensions","identifier","extraPropertiesKey","JSON","stringify","props","control","controls","form","extraProperties","ɵ0$2","ExtensionsService","Inject","ViewChildren","ExtensibleTableComponent","locale","config","trackByFn","item","actions","setColumnWidths","_actionsText","width","undefined","actionsColumn","widths","_b","columnWidths","format","getIcon","getContent","pipe","getShortDateFormat","getShortTimeFormat","getShortDateShortTimeFormat","propData","LOCALE_ID","ConfigStateService","Injector","AbstractActionsComponent","Directive","GridActionsComponent","providers","useValue","PageToolbarComponent","createInjector","token","notFoundValue","flags","DisabledDirective","ngControl","abpDisabled","NgControl","decorators","Host","PropDataDirective","tempRef","vcRef","clear","createEmbeddedView","$implicit","ngOnDestroy","TemplateRef","ViewContainerRef","createExtraPropertyValueResolver","createLocalizationStream","l10n","mapTarget","merge","languageChange","createEnumLocalizer","enumType","lookupEnum","resource","localizationResource","shortType","getShortEnumType","key","localizeWithFallbackSync","NgModule","exports","declarations","imports","CoreModule","ThemeSharedModule","NgxValidateCoreModule","NgbDatepickerModule","NgbDropdownModule","NgbTimepickerModule","selectConfig","state","ConfigState","objectExtensions","selectObjectExtensions","createSelector","ɵ1","localization","selectLocalization","ɵ2","keys","enums","reduce","acc","members","enumObject","fields","transformed","selectEnums","ɵ3","createObjectExtensionEntitiesSelector","moduleKey","modules","entities","FormGroup","extraForm","addControl","isExtraProperty","adapter","formControl","FormControl","store","select","filter","Boolean","take","switchMap","zip","generateDisplayName","generateLocalizationPipeKey","createLocalizationPipeKeyGenerator","fallback","createDisplayNameLocalizationPipeKeyGenerator","createForm","editForm","entity","properties","contributors","propName","property","typeSimple","replace","getTypeFromProperty","ui","onTable","isVisible","isSortable","LocalizationService","localizeEnum","entityProp_1","contributor","addTail","isOnCreateForm","onCreateForm","isOnEditForm","onEditForm","attributes","attr","AbpValidators","getValidatorsFromProperty","createEnumOptions","formProp_1","formContributor","createPropertiesToContributorsMapper","mapPropertiesToContributors","extension","defaultActions","_i","addManyTail","defaultProps"],"mappings":"siCAIA,SAAAA,YAGEA,EAAAC,UAAAC,UAAA,SAAUC,GACR,IAAKA,EAAO,OAAO,KAEnB,IAAMC,EAAO,IAAIC,KAAKF,GAEtB,OAAIG,MAAOF,GAAoC,MAE/CG,KAAKJ,MAAQ,CACXK,KAAMJ,EAAKK,cACXC,MAAON,EAAKO,WAAa,EACzBC,IAAKR,EAAKS,UACVC,KAAMV,EAAKW,WACXC,OAAQZ,EAAKa,aACbC,OAAQd,EAAKe,cAGRZ,KAAKJ,QAGdH,EAAAC,UAAAmB,QAAA,SAAQjB,GACN,IAAKA,EAAO,MAAO,GAEnB,IAAMkB,EAAM,IAAIhB,KAEhBF,EAAKmB,OAAAC,OAAAD,OAAAC,OAAA,CACHf,KAAMa,EAAIG,iBACVd,MAAOW,EAAIV,WAAa,EACxBC,IAAKS,EAAIR,UACTC,KAAM,EACNE,OAAQ,EACRE,OAAQ,GACLX,KAAKJ,OACLA,GAGL,IAAMC,EAAO,IAAIC,KACfF,EAAMK,KACNL,EAAMO,MAAQ,EACdP,EAAMS,IACNT,EAAMW,KACNX,EAAMa,OACNb,EAAMe,QAGR,OAAO,IAAIb,KAAKD,GAAMqB,wCAhDzBC,EAAAA;;;;;;;;;;;;;;;ACaD,IAAIC,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBL,OAAOQ,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUJ,EAAGC,GAAKD,EAAEG,UAAYF,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAII,KAAKJ,EAAOP,OAAOrB,UAAUiC,eAAeC,KAAKN,EAAGI,KAAIL,EAAEK,GAAKJ,EAAEI,MAC3EL,EAAGC,aAGZO,EAAUR,EAAGC,GAEzB,SAASQ,IAAO9B,KAAK+B,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAE3B,UAAkB,OAAN4B,EAAaP,OAAOiB,OAAOV,IAAMQ,EAAGpC,UAAY4B,EAAE5B,UAAW,IAAIoC,GA+EtDf,OAAOiB,gBAwBpBC,EAAOC,EAAGC,GACtB,IAAIC,EAAsB,mBAAXC,QAAyBH,EAAEG,OAAOC,UACjD,IAAKF,EAAG,OAAOF,EACf,IAAmBK,EAAYC,EAA3BC,EAAIL,EAAER,KAAKM,GAAOQ,EAAK,GAC3B,IACI,WAAc,IAANP,GAAgBA,KAAM,MAAQI,EAAIE,EAAEE,QAAQC,MAAMF,EAAGG,KAAKN,EAAE3C,OAExE,MAAOkD,GAASN,EAAI,CAAEM,MAAOA,WAEzB,IACQP,IAAMA,EAAEK,OAASR,EAAIK,EAAU,SAAIL,EAAER,KAAKa,WAExC,GAAID,EAAG,MAAMA,EAAEM,OAE7B,OAAOJ,WAGKK,IACZ,IAAK,IAAIL,EAAK,GAAID,EAAI,EAAGA,EAAIO,UAAUC,OAAQR,IAC3CC,EAAKA,EAAGQ,OAAOjB,EAAOe,UAAUP,KACpC,OAAOC,EA8Cc3B,OAAOiB,yBC9LhC,SAAAmB,0DAAiCtB,EAAAsB,EAAAC,GAC/BD,EAAAzD,UAAAC,UAAA,SAAUC,GACR,IAAKA,EAAO,OAAO,KAEnB,IAAMC,EAAO,IAAIC,KAAKF,GAEtB,OAAIG,MAAOF,GAAoC,KAExC,CACLQ,IAAKR,EAAKS,UACVH,MAAON,EAAKO,WAAa,EACzBH,KAAMJ,EAAKK,gBAIfiD,EAAAzD,UAAAmB,QAAA,SAAQjB,GACN,IAAKA,EAAO,MAAO,GAEnB,IAAMC,EAAO,IAAIC,KAAKF,EAAMK,KAAML,EAAMO,MAAQ,EAAGP,EAAMS,KAGzD,OAFsBgD,EAAAA,WAAWxD,EAAM,aAAc,UAnBxByD,EAAAA,oCADhCnC,EAAAA,+BCCD,SAAAoC,0DAAiC1B,EAAA0B,EAAAH,GAC/BG,EAAA7D,UAAAC,UAAA,SAAUC,GACR,IAAKA,EAAO,OAAO,KAEnB,IAAMC,EAuBV,SAAmBD,GACjB,MAAO,4CAA4C4D,KAAKC,OAAO7D,IAxBhD8D,CAAU9D,OACfE,KAAI6D,KAAAC,MAAJ9D,KAAIiD,EAAA,MAAA,EAAC,EAAG,EAAG,GAAMnD,EAAMiE,MAAM,KAAKC,IAAIC,WAC1C,IAAIjE,KAAKF,GAEb,OAAIG,MAAOF,GAAoC,KAExC,CACLU,KAAMV,EAAKW,WACXC,OAAQZ,EAAKa,aACbC,OAAQd,EAAKe,eAIjB2C,EAAA7D,UAAAmB,QAAA,SAAQjB,GACN,IAAKA,EAAO,MAAO,GAEnB,IAAMC,EAAO,IAAIC,KAAK,EAAG,EAAG,EAAGF,EAAMW,KAAMX,EAAMa,OAAQb,EAAMe,QAG/D,OAFsB0C,EAAAA,WAAWxD,EAAM,QAAS,UArBnBmE,EAAAA,yBCLjBC,EAAYC,GAC1B,OAAOA,sBDGR/C,EAAAA,mBEyCiB8C,eAmBhB,SAAAE,EAA4BC,GAAApE,KAAAoE,MAAAA,SAE5BD,EAAAzE,UAAA2E,QAAA,SAAQC,GACNtE,KAAKH,KAAK0E,WAAWD,IAGvBH,EAAAzE,UAAA8E,QAAA,SAAQF,GACNtE,KAAKyE,KAAKF,WAAWD,6BAnDxBI,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,oBACVC,SAAU,uBACVC,SAAU,gcAkBVC,gBAAiBC,EAAAA,wBAAwBC,OACzCC,cAAe,CACb,CACEC,QAASC,EAAAA,iBACTC,WAAUC,EACVC,KAAM,CAAC,CAAC,IAAIC,EAAAA,SAAY,IAAIC,EAAAA,SAAYL,EAAAA,oBAE1C,CACED,QAAS7B,EAAAA,eACToC,SAAUjG,GAEZ,CACE0F,QAASnB,EAAAA,eACT0B,SAAUjG,iDApDdkG,EAAAA,mDAyDCC,EAAAA,oBAEAC,EAAAA,UAASlB,KAAA,CAACmB,EAAAA,kCACVD,EAAAA,UAASlB,KAAA,CAACoB,EAAAA,wBClCK9B,eAoBhB,SAAA+B,EAA4B5B,EAA0C6B,GAA1CjG,KAAAoE,MAAAA,EAA0CpE,KAAAiG,MAAAA,EARtEjG,KAAAkG,SAA0CC,EAAAA,GAAG,IAE7CnG,KAAAoG,WAA4B,UAQ5BrF,OAAAsF,eAAIL,EAAAtG,UAAA,WAAQ,KAAZ,WACE,OAAOM,KAAKoG,WAAWE,MAAK,SAAAC,GAAa,OAAAA,IAAcC,EAAAA,WAAWC,YAAY,IAAM,oCAGtFT,EAAAtG,UAAAgH,aAAA,SAAaC,GACX,GAAIA,EAAKC,QAAS,MAAO,SAEzB,OAAQD,EAAKE,MACX,IAAA,UACE,MAAO,WACT,IAAA,OACE,MAAO,OACT,IAAA,WACE,MAAO,WACT,IAAA,OACE,MAAO,WACT,IAAA,OACE,MAAO,OACT,QACE,MAAO,UAIbb,EAAAtG,UAAAoH,QAAA,SAAQH,GACN,OAAQA,EAAKE,MACX,IAAA,OACA,IAAA,SACE,MAAO,OACT,IAAA,UACE,MAAO,WACT,IAAA,SACE,MAAO,SACT,IAAA,QACE,MAAO,QACT,IAAA,WACE,MAAO,WACT,QACE,MAAO,WAIbb,EAAAtG,UAAAqH,YAAA,SAAYC,OAAEL,EAAIK,EAAAL,KACVC,EAAUD,EAAKM,aAAaL,QAC5BM,EAAWP,EAAKM,aAAaC,SAC7BC,EAAWR,EAAKM,aAAaE,SAC7Bf,EAAaO,EAAKM,aAAab,WAEjCQ,IAAS5G,KAAKkG,SAAWU,EAAQ5G,KAAKoH,OACtCF,IAAUlH,KAAKkH,SAAWA,EAASlH,KAAKoH,OACxCD,IAAUnH,KAAKmH,SAAWA,EAASnH,KAAKoH,OACxChB,IAAYpG,KAAKoG,WAAaA,EAAWpG,KAAKoH,iCA/ErD1C,EAAAA,UAASC,KAAA,CAAC,CACTE,SAAU,2BACVC,SAAA,4vFACAC,gBAAiBC,EAAAA,wBAAwBC,OACzCC,cAAe,CACb,CACEC,QAASC,EAAAA,iBACTC,WAAUgC,EACV9B,KAAM,CAAC,CAAC,IAAIC,EAAAA,SAAY,IAAIC,EAAAA,SAAYL,EAAAA,oBAE1C,CAAED,QAAS7B,EAAAA,eAAgBoC,SAAUvC,GACrC,CAAEgC,QAASnB,EAAAA,eAAgB0B,SAAUnC,iDA7BvCoC,EAAAA,yBAHY2B,EAAAA,gDAoCX1B,EAAAA,oBAEAA,EAAAA,aCtCU2B,EAAuB,gCCKpC,SAAAC,0DAAiE3F,EAAA2F,EAAApE,MAAAqE,EAAAA,yBAEjE,SAAAC,YASE3G,OAAAsF,eAAIqB,EAAAhI,UAAA,OAAI,KAAR,WACE,MAAO,CACLiI,YAAa3H,KAAK2H,YAClBC,MAAO5H,KAAK4H,MACZC,OAAQ7H,KAAK6H,gDAQjB,SACkBC,EACAC,EACAC,QADA,IAAAD,IAAAA,EAAA,SAA8BE,GAAK,OAAA,SACnC,IAAAD,IAAAA,EAAA,SAA4BC,MAF5BjI,KAAA8H,WAAAA,EACA9H,KAAA+H,QAAAA,EACA/H,KAAAgI,OAAAA,gBAOpB,SAAAE,IAEUlI,KAAAmI,qBAA0E,UAElFD,EAAAxI,UAAA0I,IAAA,SAAIC,GAGF,OAFArI,KAAKmI,qBAAqBE,GAAQrI,KAAKmI,qBAAqBE,IAAS,GAE9D,IAAIrI,KAAKsI,MAAMtI,KAAKmI,qBAAqBE,uBAelD,SAAAE,EAA6BC,GAAAxI,KAAAwI,aAAAA,SAR7BzH,OAAAsF,eAAIkC,EAAA7I,UAAA,UAAO,KAAX,WACE,IAAM+I,EAAa,IAAIzI,KAAKsI,MAI5B,OAFAtI,KAAKwI,aAAaE,SAAQ,SAAAC,GAAY,OAAAA,EAASF,MAExCA,mCAKTF,EAAA7I,UAAAkJ,eAAA,SAAeC,GACb7I,KAAKwI,aAAa3F,KAAKgG,IAGzBN,EAAA7I,UAAAoJ,kBAAA,WACE,KAAO9I,KAAKwI,aAAavF,QAAQjD,KAAKwI,aAAaO,0BCvDvD,SAAAC,0DAA+CnH,EAAAmH,EAAA5F,MAAAoE,iBAE/C,SAAAyB,IAAA,IAAAC,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAAmCU,WADHnH,EAAAoH,EAAA7F,MAAAmF,iBAI5C,SAAAY,IAAA,IAAAD,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAAgCW,WADOpH,EAAAsH,EAAA/F,MAAA8E,iBAQjD,SAAAkB,EAAYxC,GAAZ,IAAAsC,EACE9F,EAAAxB,KAAA5B,KAAM4G,EAAQkB,WAAYlB,EAAQmB,QAASnB,EAAQoB,SAAOhI,YAC1DkJ,EAAKG,KAAOzC,EAAQyC,KACpBH,EAAKI,KAAO1C,EAAQ0C,MAAQ,YAPWzH,EAAAuH,EAAAhG,GAUlCgG,EAAApH,OAAP,SAAuB4E,GACrB,OAAO,IAAIwC,EAAgBxC,IAGtBwC,EAAAG,WAAP,SAA2BC,GACzB,OAAOA,EAAe1F,IAAIsF,EAAapH,YAfAyH,iBChB3C,SAAAC,0DAA6D7H,EAAA6H,EAAAtG,MAAAqE,EAAAA,yBAE7D,SAAAkC,YASE5I,OAAAsF,eAAIsD,EAAAjK,UAAA,OAAI,KAAR,WACE,MAAO,CACLiI,YAAa3H,KAAK2H,YAClBC,MAAO5H,KAAK4H,MACZC,OAAQ7H,KAAK6H,gDAQjB,SACkBhB,EACAwB,EACAuB,EACA9B,EACAC,EACA8B,QADA,IAAA9B,IAAAA,EAAA,SAA4BE,GAAK,OAAA,SACjC,IAAA4B,IAAAA,GAAA,GALA7J,KAAA6G,KAAAA,EACA7G,KAAAqI,KAAAA,EACArI,KAAA4J,YAAAA,EACA5J,KAAA8H,WAAAA,EACA9H,KAAA+H,QAAAA,EACA/H,KAAA6J,QAAAA,EAEhB7J,KAAK4J,YAAc5J,KAAK4J,aAAe5J,KAAKqI,mBAOhD,SAAAyB,IAEU9J,KAAAmI,qBAAsE,UAE9E2B,EAAApK,UAAA0I,IAAA,SAAIC,GAGF,OAFArI,KAAKmI,qBAAqBE,GAAQrI,KAAKmI,qBAAqBE,IAAS,GAE9D,IAAIrI,KAAKsI,MAAMtI,KAAKmI,qBAAqBE,uBAelD,SAAA0B,EAA6BvB,GAAAxI,KAAAwI,aAAAA,SAR7BzH,OAAAsF,eAAI0D,EAAArK,UAAA,QAAK,KAAT,WACE,IAAMsK,EAAW,IAAIhK,KAAKsI,MAI1B,OAFAtI,KAAKwI,aAAaE,SAAQ,SAAAC,GAAY,OAAAA,EAASqB,MAExCA,mCAKTD,EAAArK,UAAAkJ,eAAA,SAAeC,GACb7I,KAAKwI,aAAa3F,KAAKgG,IAGzBkB,EAAArK,UAAAoJ,kBAAA,WACE,KAAO9I,KAAKwI,aAAavF,QAAQjD,KAAKwI,aAAaO,0BC1DvD,SAAAkB,0DAA6CpI,EAAAoI,EAAA7G,MAAAsG,iBAE7C,SAAAQ,IAAA,IAAAhB,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAAiC2B,WADHpI,EAAAqI,EAAA9G,MAAA2G,iBAI1C,SAAAI,IAAA,IAAAjB,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAA8B4B,WADOrI,EAAAsI,EAAA/G,MAAA0G,iBAU/C,SAAAM,EAAYxD,GAAZ,IAAAsC,EACE9F,EAAAxB,KAAA5B,KACE4G,EAAQC,KACRD,EAAQyB,KACRzB,EAAQgD,YACRhD,EAAQkB,WACRlB,EAAQmB,QACRnB,EAAQiD,UACT7J,YAEDkJ,EAAKmB,YAAczD,EAAQyD,YAC3BnB,EAAKoB,SAAW1D,EAAQ0D,WAAY,EACpCpB,EAAKqB,cAAgB3D,EAAQ2D,eAAa,SAAKnD,GAAQ,OAAAjB,EAAAA,GAAGiB,EAAKS,OAAOqB,EAAKb,QAC3Ea,EAAKlB,OAASpB,EAAQoB,gBAnBenG,EAAAuI,EAAAhH,GAsBhCgH,EAAApI,OAAP,SAAuB4E,GACrB,OAAO,IAAIwD,EAAcxD,IAGpBwD,EAAAb,WAAP,SAA2BC,GACzB,OAAOA,EAAe1F,IAAIsG,EAAWpI,YA3BAwI,iBCPzC,SAAAC,0DAA2C5I,EAAA4I,EAAArH,MAAAsG,iBAE3C,SAAAgB,IAAA,IAAAxB,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAA+BmC,WADH5I,EAAA6I,EAAAtH,MAAA2G,iBAIxC,SAAAY,IAAA,IAAAzB,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAA4BoC,WADa7I,EAAA8I,EAAAvH,MAAA0G,iBAIrD,SAAAc,IAAA,IAAA1B,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAA4BoC,WADW7I,EAAA+I,EAAAxH,MAAA0G,iBAcjD,SAAAe,EAAYjE,GAAZ,IAAAsC,EACE9F,EAAAxB,KAAA5B,KACE4G,EAAQC,KACRD,EAAQyB,KACRzB,EAAQgD,YACRhD,EAAQkB,WACRlB,EAAQmB,QACRnB,EAAQiD,UACT7J,KAEDkJ,EAAK4B,gBAAkBlE,EAAQkE,iBAAe,SAAK7C,GAAK,MAAA,IACxDiB,EAAK9C,WAAaQ,EAAQR,YAAU,SAAK6B,GAAK,MAAA,IAC9CiB,EAAK/B,SAAWP,EAAQO,UAAQ,SAAKc,GAAK,OAAA,GAC1CiB,EAAKhC,SAAWN,EAAQM,UAAQ,SAAKe,GAAK,OAAA,GAC1CiB,EAAK6B,aAAenE,EAAQmE,cAAgB,MAC5C7B,EAAKtC,QAAUA,EAAQA,QACvBsC,EAAK8B,GAAKpE,EAAQoE,IAAMpE,EAAQyB,KAChC,IAAM4C,EAAerE,EAAQqE,oBAC7B/B,EAAK+B,aA8CT,SAAsBA,GACpB,MAAO,CAAC,EAAG,IAAI,GAAOC,QAAQD,IAAwB,EA/ChCE,CAAaF,GAAgBA,EAAeA,GAAgB,cA5B7CpJ,EAAAgJ,EAAAzH,GA+B9ByH,EAAA7I,OAAP,SAAuB4E,GACrB,OAAO,IAAIiE,EAAYjE,IAGlBiE,EAAAtB,WAAP,SAA2BC,GACzB,OAAOA,EAAe1F,IAAI+G,EAAS7I,YApCAwI,iBA2CrC,SAAAY,EAAYC,EAAoCxD,GAAhD,IAAAqB,EACE9F,EAAAxB,KAAA5B,OAAOA,YADuCkJ,EAAArB,OAAAA,EAI9CqB,EAAKvB,YAAc0D,EAASjD,IAAIzE,KAAK0H,YAPExJ,EAAAuJ,EAAAhI,MAAAuG,qBC5D3C,SAAA2B,0DAAgDzJ,EAAAyJ,EAAAlI,MAAAoE,iBAKhD,SAAA+D,IAAA,IAAArC,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAAoCgD,WADHzJ,EAAA0J,EAAAnI,MAAAmF,iBAI7C,SAAAiD,IAAA,IAAAtC,EAAA9F,EAAAQ,MAAA5D,KAAA+C,EAAAC,aAAAhD,YACYkJ,EAAAZ,MAAiCiD,WADO1J,EAAA2J,EAAApI,MAAA8E,iBAQlD,SAAAuD,EAAY7E,GAAZ,IAAAsC,EACE9F,EAAAxB,KAAA5B,KAAM4G,EAAQkB,WAAYlB,EAAQmB,QAASnB,EAAQoB,SAAOhI,YAC1DkJ,EAAKG,KAAOzC,EAAQyC,KACpBH,EAAKI,KAAO1C,EAAQ0C,MAAQ,YAPYzH,EAAA4J,EAAArI,GAUnCqI,EAAAzJ,OAAP,SAAuB4E,GACrB,OAAO,IAAI6E,EAAiB7E,IAGvB6E,EAAAlC,WAAP,SAA2BC,GACzB,OAAOA,EAAe1F,IAAI2H,EAAczJ,YAfAyH,iBAsB1C,SAAAiC,EAAY9E,GAAZ,IAAAsC,EACE9F,EAAAxB,KAAA5B,KAAM4G,EAAQkB,WAAYlB,EAAQmB,QAASnB,EAAQoB,SAAOhI,YAC1DkJ,EAAKyC,UAAY/E,EAAQ+E,mBALkB9J,EAAA6J,EAAAtI,GAQtCsI,EAAA1J,OAAP,SAAuB4E,GACrB,OAAO,IAAI8E,EAAoB9E,IAG1B8E,EAAAnC,WAAP,SAA2BC,GACzB,OAAOA,EAAe1F,IAAI4H,EAAiB1J,YAbAyH,MCtC/C,WAIWzJ,KAAA4L,cAAgB,IAAIzC,EACpBnJ,KAAA6L,eAAiB,IAAIL,EACrBxL,KAAA8L,YAAc,IAAI3B,EAClBnK,KAAA+L,gBAAkB,IAAIpB,EACtB3K,KAAAgM,cAAgB,IAAIpB,sHAR9BzJ,EAAAA,WAAUwD,KAAA,CAAC,CACVsH,WAAY,eCHDC,GAAwB,IAAIC,EAAAA,eAAuB,yBAGnDC,GAAyB,IAAID,EAAAA,eAA2B,0BAExDE,GAAyB,IAAIF,EAAAA,eAA2B,0BACxDG,GAA6B,IAAIH,EAAAA,eAC5C,6BCiBgBlI,gBA4BhB,SAAAsI,EACkBnI,EACA6B,EACRuG,EACAC,EAC+BC,GAJvB1M,KAAAoE,MAAAA,EACApE,KAAAiG,MAAAA,EACRjG,KAAAwM,UAAAA,EACAxM,KAAAyM,WAAAA,EAC+BzM,KAAA0M,WAAAA,EAjBzC1M,KAAA2M,mBAAqBpF,SAPrBxG,OAAAsF,eACIkG,EAAA7M,UAAA,iBAAc,KADlB,SACmBmI,GACjB,IAAMhB,EAAQgB,GAAqC,OAA3B+E,KAAKC,UAAUhF,GAA8B,OAAX,SAC1D7H,KAAKgK,SAAWhK,KAAKyM,WAAc5F,EAAI,aAAauB,IAAIpI,KAAK0M,YAAYI,MACzE9M,KAAK6H,OAASA,mCAOhB9G,OAAAsF,eAAIkG,EAAA7M,UAAA,OAAI,KAAR,WACE,OAAQM,KAAKwM,UAAYxM,KAAKwM,UAAUO,QAAU,CAAEC,SAAU,qCAGhEjM,OAAAsF,eAAIkG,EAAA7M,UAAA,kBAAe,KAAnB,WACE,OAAQM,KAAKiN,KAAKD,SAASE,iBAAmB,CAAEF,SAAU,+DAjC7DtI,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,oBACVC,SAAU,sBACVC,SAAA,y2BACAC,gBAAiBC,EAAAA,wBAAwBC,OACzCC,cAAe,CACb,CACEC,QAASC,EAAAA,iBACTC,WAAU8H,GACV5H,KAAM,CAAC,CAAC,IAAIC,EAAAA,SAAY,IAAIC,EAAAA,SAAYL,EAAAA,mEA1B5CO,EAAAA,yBAHO2B,EAAAA,sBAYAlC,EAAAA,wBAGAgI,mCA8CJC,EAAAA,OAAM1I,KAAA,CAACuH,6CA3BToB,EAAAA,aAAY3I,KAAA,CAACqB,2BAGbJ,EAAAA,SCNH,kBAoCE,SAAA2H,EAC6BC,EACnBC,EACRpC,GAF2BrL,KAAAwN,OAAAA,EACnBxN,KAAAyN,OAAAA,EAJDzN,KAAA0N,UAA4C,SAACzF,EAAG0F,GAAS,OAAAA,EAAKtF,MAQrErI,KAAK2H,YAAc0D,EAASjD,IAAIzE,KAAK0H,GACrC,IAAMoB,EAAapB,EAASjD,IAAIgF,IAC1B/E,EAAOgD,EAASjD,IAAI8D,IAC1BlM,KAAKgK,SAAWyC,EAAWX,YAAY1D,IAAIC,GAAMyE,MACjD9M,KAAKyI,WAAcgE,EAA0B,cAAErE,IAAIC,GAChDuF,QACH5N,KAAK6N,gBAhD4B,YAUnC9M,OAAAsF,eACIkH,EAAA7N,UAAA,cAAW,KAGf,iBACE,OAAwB,QAAxBsH,EAAOhH,KAAK8N,oBAAY,IAAA9G,EAAAA,EAAKhH,KAAKyI,WAAWxF,OAAS,EAAI,iBAAmB,QAL/E,SACgBrD,GACdI,KAAK8N,aAAelO,mCAStBmB,OAAAsF,eAAakH,EAAA7N,UAAA,qBAAkB,KAA/B,SAAgCqO,GAC9B/N,KAAK6N,gBAAgBE,EAAQhK,OAAOgK,QAASC,oCA6BvCT,EAAA7N,UAAAmO,gBAAA,SAAgBI,GACtB,IAAMC,EAAS,CAACD,GAChBjO,KAAKgK,SAAStB,SAAQ,SAACyF,OAASxH,EAAIwH,EAAAvO,MAClCsO,EAAOrL,KAAK8D,EAAK0D,gBAElBrK,KAAKoO,aAAuBF,GAGvBX,EAAA7N,UAAAY,QAAA,SAAQV,EAAayO,GAC3B,OAAOzO,EAAQyD,EAAAA,WAAWzD,EAAOyO,EAAQrO,KAAKwN,QAAU,IAGlDD,EAAA7N,UAAA4O,QAAA,SAAQ1O,GACd,OAAOA,EACH,0EACA,0EAGN2N,EAAA7N,UAAA6O,WAAA,SAAW5H,EAAqBS,GAAhC,IAAA8B,EAAAlJ,KACE,OAAO2G,EAAK4D,cAAcnD,GAAMoH,KAC9B1K,EAAAA,KAAI,SAAAlE,GACF,OAAQ+G,EAAKE,MACX,IAAA,UACE,OAAOqC,EAAKoF,QAAQ1O,GACtB,IAAA,OACE,OAAOsJ,EAAK5I,QAAQV,EAAO6O,EAAAA,mBAAmBvF,EAAKuE,SACrD,IAAA,OACE,OAAOvE,EAAK5I,QAAQV,EAAO8O,EAAAA,mBAAmBxF,EAAKuE,SACrD,IAAA,WACE,OAAOvE,EAAK5I,QAAQV,EAAO+O,EAAAA,4BAA4BzF,EAAKuE,SAC9D,QACE,OAAO7N,QAOjB2N,EAAA7N,UAAAqH,YAAA,SAAYoH,GAAZ,IAAAjF,EAAAlJ,KAAcoH,EAAI+G,EAAA/G,MACXA,MAAAA,OAAI,EAAJA,EAAMH,gBAEXjH,KAAKoH,KAAOA,EAAKH,aAAanD,KAAI,SAAC+D,EAAQD,GASzC,OARAsB,EAAKc,SAAStB,SAAQ,SAAA/B,GACpB,IAAMiI,EAAW,CAAEjH,YAAauB,EAAKvB,YAAaE,OAAMA,EAAED,MAAKA,GAC/DC,EAAO,IAAIlB,EAAK/G,MAAMyI,MAAU,CAC9BN,QAASpB,EAAK/G,MAAMmI,QAAQ6G,GAC5BhP,MAAOsJ,EAAKqF,WAAW5H,EAAK/G,MAAOgP,OAIhC/G,iCAnGZnD,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,qBACVC,SAAU,uBACVC,SAAA,2nDACAC,gBAAiBC,EAAAA,wBAAwBC,8EA+BtCoI,EAAAA,OAAM1I,KAAA,CAACkK,EAAAA,oBAlEVC,EAAAA,0BAUAC,EAAAA,kDA6BCnJ,EAAAA,oBAQAA,EAAAA,oBACAA,EAAAA,4BACAA,EAAAA,kCACAA,EAAAA,+BAGAA,EAAAA,4BCrCD,SAAAoJ,EAAY3D,GAAZ,IAAAnC,EACE9F,EAAAxB,KAAA5B,OAAOA,KAGPkJ,EAAKvB,YAAc0D,EAASjD,IAAIzE,KAAK0H,GACrC,IAAMoB,EAAapB,EAASjD,IAAIgF,IAC1B/E,EAAOgD,EAASjD,IAAI8D,IACpBrF,EAAOwE,EAASjD,IAAIgE,WAC1BlD,EAAKT,WAAcgE,EAAW5F,GAAMuB,IAAIC,GAAMuF,iBAjBgC/L,EAAAmN,EAAA5L,MAAAsE,wBADjFuH,EAAAA,sDARmBF,EAAAA,6CAgBjBnJ,EAAAA,4BCgBD,SAAAsJ,EAAY7D,GAAZ,IAAAnC,EACE9F,EAAAxB,KAAA5B,KAAMqL,IAASrL,YATRkJ,EAAAI,KAAO,YAIPJ,EAAAG,KAAO,GAEPH,EAAAwE,UAA8C,SAACzF,EAAG0F,GAAS,OAAAA,EAAKtE,eAPxBxH,EAAAqN,EAAA9L,MAAA4L,yBAZlDtK,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iBACVC,SAAU,mBACVC,SAAA,26CACAqK,UAAW,CACT,CACEhK,QAASiH,GACTgD,SAAU,kBAGdrK,gBAAiBC,EAAAA,wBAAwBC,qDAlBzC8J,EAAAA,2CAqBCnJ,EAAAA,qBAEAA,EAAAA,oBAEAA,EAAAA,4BCKD,SAAAyJ,EAA6BhE,GAA7B,IAAAnC,EACE9F,EAAAxB,KAAA5B,KAAMqL,IAASrL,YADYkJ,EAAAmC,SAAAA,EAHpBnC,EAAAwE,UAAkD,SAACzF,EAAG0F,GAC7D,OAAAA,EAAK3F,QAAU2F,EAAKhC,oBAF2B9J,EAAAwN,EAAAjM,GAQjDiM,EAAA3P,UAAA4P,eAAA,SAAetH,GAAf,IAAAkB,EAAAlJ,KASE,MAAO,CAAEoI,IARG,SAAImH,EAAoCC,EAAmBC,GACrE,OAAOF,IAAUlD,GACbnD,EAAK9B,KACLmI,IAAUjD,GACV,SAAClF,GAAqB,YAArB,IAAAA,IAAAA,EAAO8B,EAAK9B,MAASY,EAAOA,OAAOZ,IACpC8B,EAAKvB,YAAY/F,KAAKsH,EAAKmC,SAAUkE,EAAOC,EAAeC,SAdlBT,yBAZlDtK,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iBACVC,SAAU,mBACVC,SAAA,wzBACAqK,UAAW,CACT,CACEhK,QAASiH,GACTgD,SAAU,mBAGdrK,gBAAiBC,EAAAA,wBAAwBC,qDAtBzC8J,EAAAA,8BCKA,SAAAW,EAA4BC,GAAA3P,KAAA2P,UAAAA,SAG5BD,EAAAhQ,UAAAqH,YAAA,SAAYC,OAAE4I,EAAW5I,EAAA4I,YACnB5P,KAAK2P,UAAU5C,SAAW6C,GAC5B5P,KAAK2P,UAAU5C,QAAQ6C,EAAY3I,aAAe,UAAY,uCAZnEgI,EAAAA,UAAStK,KAAA,CAAC,CACTE,SAAU,8DAHHgL,EAAAA,UAASC,WAAA,CAAA,CAAAjJ,KASHkJ,EAAAA,gDAHZnK,EAAAA,4BCoBD,SAAAoK,EACUC,EACAC,EACR7E,GAHF,IAAAnC,EAKE9F,EAAAxB,KAAA5B,OAAOA,YAJCkJ,EAAA+G,QAAAA,EACA/G,EAAAgH,MAAAA,EAMRhH,EAAKvB,YAAc0D,EAASjD,IAAIzE,KAAK0H,YApBuBxJ,EAAAmO,EAAA5M,GAuB9D4M,EAAAtQ,UAAAqH,YAAA,WACE/G,KAAKkQ,MAAMC,QAEXnQ,KAAKkQ,MAAME,mBAAmBpQ,KAAKiQ,QAAS,CAC1CI,UAAWrQ,KAAKoH,KAChBQ,MAAO,KAIXoI,EAAAtQ,UAAA4Q,YAAA,WACEtQ,KAAKkQ,MAAMC,YAjCiDxG,wBAJ/DsF,EAAAA,UAAStK,KAAA,CAAC,CACTC,SAAU,cACVC,SAAU,8DAPV0L,EAAAA,mBACAC,EAAAA,wBALAzB,EAAAA,+CAgBCnJ,EAAAA,MAAKjB,KAAA,CAAC,uCAENiB,EAAAA,MAAKjB,KAAA,CAAC,wCAENiB,EAAAA,MAAKjB,KAAA,CAAC,mECyBT,sBC5BgB8L,GAAoCpI,GAClD,OAAO,SAACjB,GAAuB,OAAAjB,EAAAA,GAAGiB,EAAKS,OAA2B,gBAAEQ,KC8BtE,SAASqI,GAAyBC,EAA2BC,GAC3D,OAAOC,EAAAA,MAAM1K,EAAAA,GAAG,MAAOwK,EAAKG,gBAAgBtC,KAAK1K,EAAAA,KAAI,WAAM,OAAA8M,MAG7D,SAASG,GACPJ,EACAK,EACAC,GAEA,IAAMC,EAAWD,EAAWE,qBACtBC,EAUR,SAA0BJ,GACxB,OAAOA,EAASnN,MAAM,KAAKkF,MAXTsI,CAAiBL,GAEnC,OAAO,SAAAM,GACL,OAAAX,EAAKY,yBACH,CAACL,GACD,CAAC,QAAUE,EAAY,IAAME,EAAKF,EAAY,IAAME,EAAKA,GACzDA,yBFhDLE,EAAAA,SAAQ7M,KAAA,CAAC,CACR8M,QAAS,CACPtN,EACAkL,GACAH,GACA3C,GACAgB,GACAyC,GACAN,IAEFgC,aAAc,CACZvN,EACAkL,GACAH,GACAlJ,EACAuG,GACAgB,GACAyC,GACAN,IAEFiC,QAAS,CACPC,EAAAA,WACAC,EAAAA,kBACAC,EAAAA,sBACAC,EAAAA,oBACAC,EAAAA,kBACAC,EAAAA,yBG9BJ,IAAMC,GAAe,SAACC,GAAe,OAAAA,EAAMC,gBAIzC,SAAC3E,GAAoC,OAAAA,EAAO4E,kBAFxCC,GAAyBC,EAAAA,eAC7B,CAACL,IAAaM,OAMd,SAAC/E,GAA8C,OAAAA,EAAOgF,cAFlDC,GAAqBH,EAAAA,eACzB,CAACL,IAAaS,OAMd,SAAClG,GACC,OAAA1L,OAAO6R,KAAKnG,EAAWoG,OAAOC,QAAO,SAACC,EAAKzB,GACnC,IDvBe0B,EACnBC,ECsBIjM,EAAmCyF,EAAWoG,MAAMvB,GAAlD4B,EAAMlM,EAAAkM,OAAE/B,EAAoBnK,EAAAmK,qBAMpC,OALA4B,EAAIzB,GAAO,CACT4B,OAAMA,EACN/B,qBAAoBA,EACpBgC,aD3BmBH,EC2BKE,ED1BxBD,EAAkB,GAExBD,EAAQtK,SAAQ,SAAC1B,OAAEqB,EAAIrB,EAAAqB,KAAEzI,EAAKoH,EAAApH,MAC5BqT,EAAYA,EAAW5K,GAAQzI,GAAUyI,KAGpC4K,ICsBIF,IACN,KAXDK,GAAcb,EAAAA,eAClB,CAACD,GAAwBI,IAAmBW,IAaxCC,GAAwC,SAACC,GAC7C,OAAAhB,EAAAA,eAAe,CAACD,KAAyB,SAAC7F,GACxC,OAAKA,GAEGA,EAAW+G,QAAQD,IAAe,IAAgCE,SAFlD,q8BC/ByBrM,GACnD,IAAMqF,EAAarF,EAAKO,YAAYyF,IAC9BV,EAAatF,EAAKO,YAAYuE,IAE9Be,EAAO,IAAIyG,EAAAA,UAAU,IACrBC,EAAY,IAAID,EAAAA,UAAU,IAChCzG,EAAK2G,WAAWrM,EAAsBoM,GAEtC,IAAM9L,EAAST,EAAKS,QAAU,GAExBiF,EAAyBL,GADS,OAA3BG,KAAKC,UAAUhF,GAAmB,SAAW,QACT,aAAaO,IAAIsE,GAAYI,MACxEI,EAAkBrF,EAA2B,iBAAK,GAqCxD,OAnCAiF,EAAMpE,SAAQ,SAAC1B,OAASL,EAAIK,EAAApH,MACpByI,EAAO1B,EAAK0B,KACZwL,EAAkBlN,EAAKkD,SAAWxB,KAAQ6E,EAC5CtN,EAAQiU,EAAkB3G,EAAgB7E,GAAQA,KAAQR,EAASA,EAAOQ,QAAQ2F,EAItF,QAFqB,IAAVpO,IAAuBA,EAAQ+G,EAAKsE,cAE3CrL,EAAO,CACT,IAAIkU,OAAoD,EACxD,OAAQnN,EAAKE,MACX,IAAA,OAEEjH,GADAkU,EAAU,IAAI3Q,GACEtC,QAAQiT,EAAQnU,UAAUC,IAC1C,MACF,IAAA,OAEEA,GADAkU,EAAU,IAAIvQ,GACE1C,QAAQiT,EAAQnU,UAAUC,IAC1C,MACF,IAAA,WAEEA,GADAkU,EAAU,IAAIrU,GACEoB,QAAQiT,EAAQnU,UAAUC,KAOhD,IAAMmU,EAAc,IAAIC,EAAAA,YAAYpU,EAAO,CACzCkL,gBAAiBnE,EAAKmE,gBAAgB1D,GACtChB,WAAYO,EAAKP,WAAWgB,MAG7ByM,EAAkBF,EAAY1G,GAAM2G,WAAWvL,EAAM0L,MAGjD9G,kDDZ2CgH,EAAcV,GAChE,OAAOU,EAAMC,OAAOZ,GAAsCC,IAAY/E,KACpE1K,EAAAA,KAAI,SAAA2P,GAAY,YAwHI,IAxHSA,EAAY,GAAKA,KAC9CU,EAAAA,OAAkCC,SAClCC,EAAAA,KAAK,0CAI0CJ,EAAc/C,GAC/D,OAAO1C,EAAAA,KACL8F,EAAAA,WAAU,SAAAb,GACR,OAAAc,EAAAA,IAAIN,EAAMC,OAAOxB,IAAqBuB,EAAMC,OAAOd,KAAc5E,KAC/D1K,EAAAA,KAAI,SAACkD,OAAAmH,EAAAlM,EAAA+E,EAAA,GAACyL,EAAYtE,EAAA,GAAE0E,EAAK1E,EAAA,GACjBqG,WExDd/B,GAEA,IAAMgC,EAA8BC,EAAAA,mCAAmCjC,GAEvE,OAAO,SAAC7I,EAA2C+K,GACjD,OAAI/K,GAAeA,EAAYvB,KACtBoM,EACL,CAAC7K,EAAYsH,UACb,CAACtH,EAAYvB,MACbuB,EAAYvB,MAGJoM,EACV,CAACE,EAASzD,UACV,CAAC,eAAiByD,EAAStM,WAC3B2F,IAKKyG,EAA4B,CAACE,EAASzD,UAAW,CAACyD,EAAStM,MAAOsM,EAAStM,OFoChDuM,CAA8CnC,GAE1E,OAAO1R,OAAO6R,KAAKa,GAAUX,QAC3B,SAACC,EAAKzB,GACJyB,EAAIpM,KAAK2K,GAAO,GAChByB,EAAI8B,WAAWvD,GAAO,GACtByB,EAAI+B,SAASxD,GAAO,GAEpB,IAAMyD,EAAkCtB,EAASnC,GACjD,IAAKyD,EAAQ,OAAOhC,EAEpB,IAAMiC,EAAaD,EAAOC,WAC1B,OAAKA,EAuBnB,SACER,EACAtD,EACA2B,GAEA,OAAO,SACLmC,EACAC,EACA3D,GAEA,IAAMzH,GAAU,EAuDhB,OArDA9I,OAAO6R,KAAKoC,GAAYtM,SAAQ,SAACL,GAC/B,ID1FJ2I,EACAC,EACAiE,ECwFUC,EAAWH,EAAW3M,GACtBxB,EAuDZ,SAA6BsO,GAC3B,OAAQA,EAASC,WAAWC,QAAQ,MAAO,IAxD1BC,CAAoBH,GAC3BvL,EAAc4K,EAAoBW,EAASvL,YAAa,CAAEvB,KAAIA,EAAE6I,SAAQA,IAE9E,GAAIiE,EAASI,GAAGC,QAAQC,UAAW,CACjC,IAAMnL,EAAW8J,QAAQe,EAASI,GAAGC,QAAQE,YACvCrL,EAAkB,YAAJxD,EAA6B,IAAM,IACjD0D,EACA,SAAJ1D,GDlGRmK,ECmGoCmE,EAAStO,KDlG7CoK,ECkGmD4B,EAAMsC,EAAStO,MDjGlEqO,ECiGyE7M,ED/FlE,SAAAjB,GACL,IAAMxH,EAAQwH,EAAKS,OAA2B,gBAAEqN,GAC1C5D,EAAML,EAAWkC,YAAYvT,GAC7B+Q,EAAOvJ,EAAKO,YAAYgO,EAAAA,qBAG9B,OAAOjF,GAAyBC,EAFXI,GAAoBJ,EAAMK,EAAUC,EAEnB2E,CAAatE,MC0FzCb,GAAoCpI,GAEpCwN,EAAa,IAAIzL,EAAc,CACnCvD,KAAIA,EACJwB,KAAIA,EACJuB,YAAWA,EACXU,SAAQA,EACRD,YAAWA,EACXE,cAAaA,EACbV,QAAOA,IAGHiM,EAAc,SAAC9L,GAAgC,OAAAA,EAAS+L,QAAQF,IACtEZ,EAAatO,KAAK2K,GAAKzO,KAAKiT,GAG9B,IAAME,EAAiBb,EAASI,GAAGU,aAAaR,UAC1CS,EAAef,EAASI,GAAGY,WAAWV,UAE5C,GAAIO,GAAkBE,EAAc,CAClC,IAAMjL,EAAekK,EAASlK,aACxB7E,EAAa,WAAM,gBGvIS+O,GACxC,IAAM/O,EAA4B,GAOlC,OALA+O,EAASiB,WAAW1N,SAAQ,SAAA2N,GACtBA,EAAKjB,cAAckB,EAAAA,eACrBlQ,EAAWvD,KAAKyT,EAAAA,cAAcD,EAAKjB,YAAYiB,EAAK5I,YAGjDrH,EH+HwBmQ,CAA0BpB,IAC/CvO,OAAyD,EACrD,SAAJC,IAAyBD,WD5GnCoK,EACAC,GAEA,OAAO,SAAA7J,GACL,IAAMuJ,EAAOvJ,EAAKO,YAAYgO,EAAAA,qBACxBC,EAAe7E,GAAoBJ,EAAMK,EAAUC,GAEzD,OAAOP,GACLC,EACAM,EAAWiC,OAAOpP,KAAI,SAACkD,OAAEqB,EAAIrB,EAAAqB,KAAEzI,EAAKoH,EAAApH,MAAO,MAAA,CACzC0R,IAAKsE,EAAavN,GAClBzI,MAAKA,QCiGkC4W,CAAkBnO,EAAMwK,EAAMsC,EAAStO,QAE9E,IAAM4P,EAAW,IAAI5L,EAAS,CAC5BhE,KAAIA,EACJwB,KAAIA,EACJuB,YAAWA,EACXhD,QAAOA,EACPqE,aAAYA,EACZ7E,WAAUA,EACVyD,QAAOA,IAGH6M,EAAkB,SAAC1M,GAA8B,OAAAA,EAAS+L,QAAQU,IAEpET,GAAgBf,EAAaJ,WAAWvD,GAAKzO,KAAK6T,GAClDR,GAAcjB,EAAaH,SAASxD,GAAKzO,KAAK6T,OAI/CzB,GAtFuC0B,CAClCnC,EACAtD,EACA2B,EAGK+D,CAA4B5B,EAAYjC,EAAKzB,GAR5ByB,IAU1B,CACEpM,KAAM,GACNkO,WAAY,GACZC,SAAU,YAMpBT,EAAAA,KAAK,wCI5EPwC,EACAC,OACA,IAAA7B,EAAA,GAAA8B,EAAA,EAAAA,EAAA/T,UAAAC,OAAA8T,IAAA9B,EAAA8B,EAAA,GAAA/T,UAAA+T,GAEAhW,OAAO6R,KAAKkE,GAAgBpO,SAAQ,SAACL,GACnC,IAAMuF,EAA8BiJ,EAAUzO,IAAIC,GAClDuF,EAAQ9E,oBACR8E,EAAQhF,gBAAe,SAACH,GACtB,OAAAA,EAAWuO,YAAYF,EAAezO,OAExC4M,EAAavM,SAAQ,SAAAoN,GACnB,OAACA,EAAYzN,IAAS,IAAIK,SAAQ,SAACC,GACjC,OAAAiF,EAAQhF,eAAeD,8CNH7BkO,EACAI,OACA,IAAAhC,EAAA,GAAA8B,EAAA,EAAAA,EAAA/T,UAAAC,OAAA8T,IAAA9B,EAAA8B,EAAA,GAAA/T,UAAA+T,GAEAhW,OAAO6R,KAAKqE,GAAcvO,SAAQ,SAACL,GACjC,IAAMyE,EAA0B+J,EAAUzO,IAAIC,GAC9CyE,EAAMhE,oBACNgE,EAAMlE,gBAAe,SAACoB,GAAuB,OAAAA,EAASgN,YAAYC,EAAa5O,OAC/E4M,EAAavM,SAAQ,SAAAoN,GACnB,OAACA,EAAYzN,IAAS,IAAIK,SAAQ,SAACC,GACjC,OAAAmE,EAAMlE,eAAeD","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { NgbDateStruct, NgbTimeStruct } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Injectable()\r\nexport class DateTimeAdapter {\r\n  value: NgbDateTimeStruct;\r\n\r\n  fromModel(value: string | Date): NgbDateTimeStruct | null {\r\n    if (!value) return null;\r\n\r\n    const date = new Date(value);\r\n\r\n    if (isNaN((date as unknown) as number)) return null;\r\n\r\n    this.value = {\r\n      year: date.getFullYear(),\r\n      month: date.getMonth() + 1,\r\n      day: date.getDate(),\r\n      hour: date.getHours(),\r\n      minute: date.getMinutes(),\r\n      second: date.getSeconds(),\r\n    };\r\n\r\n    return this.value;\r\n  }\r\n\r\n  toModel(value: NgbDateTimeStruct | null): string {\r\n    if (!value) return '';\r\n\r\n    const now = new Date();\r\n\r\n    value = {\r\n      year: now.getUTCFullYear(),\r\n      month: now.getMonth() + 1,\r\n      day: now.getDate(),\r\n      hour: 0,\r\n      minute: 0,\r\n      second: 0,\r\n      ...this.value,\r\n      ...value,\r\n    };\r\n\r\n    const date = new Date(\r\n      value.year,\r\n      value.month - 1,\r\n      value.day,\r\n      value.hour,\r\n      value.minute,\r\n      value.second,\r\n    );\r\n\r\n    return new Date(date).toISOString();\r\n  }\r\n}\r\n\r\ntype NgbDateTimeStruct = NgbDateStruct & NgbTimeStruct;\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { formatDate } from '@angular/common';\r\nimport { Injectable } from '@angular/core';\r\nimport { NgbDateAdapter, NgbDateStruct } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Injectable()\r\nexport class DateAdapter extends NgbDateAdapter<string> {\r\n  fromModel(value: string | Date): NgbDateStruct | null {\r\n    if (!value) return null;\r\n\r\n    const date = new Date(value);\r\n\r\n    if (isNaN((date as unknown) as number)) return null;\r\n\r\n    return {\r\n      day: date.getDate(),\r\n      month: date.getMonth() + 1,\r\n      year: date.getFullYear(),\r\n    };\r\n  }\r\n\r\n  toModel(value: NgbDateStruct | null): string {\r\n    if (!value) return '';\r\n\r\n    const date = new Date(value.year, value.month - 1, value.day);\r\n    const formattedDate = formatDate(date, 'yyyy-MM-dd', 'en');\r\n\r\n    return formattedDate;\r\n  }\r\n}\r\n","import { formatDate } from '@angular/common';\r\nimport { Injectable } from '@angular/core';\r\nimport { NgbTimeAdapter, NgbTimeStruct } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@Injectable()\r\nexport class TimeAdapter extends NgbTimeAdapter<string> {\r\n  fromModel(value: string | Date): NgbTimeStruct | null {\r\n    if (!value) return null;\r\n\r\n    const date = isTimeStr(value)\r\n      ? new Date(0, 0, 1, ...value.split(':').map(Number))\r\n      : new Date(value);\r\n\r\n    if (isNaN((date as unknown) as number)) return null;\r\n\r\n    return {\r\n      hour: date.getHours(),\r\n      minute: date.getMinutes(),\r\n      second: date.getSeconds(),\r\n    };\r\n  }\r\n\r\n  toModel(value: NgbTimeStruct | null): string {\r\n    if (!value) return '';\r\n\r\n    const date = new Date(0, 0, 1, value.hour, value.minute, value.second);\r\n    const formattedDate = formatDate(date, 'HH:mm', 'en');\r\n\r\n    return formattedDate;\r\n  }\r\n}\r\n\r\nfunction isTimeStr(value: string | Date): value is string {\r\n  return /^((2[123])|[01][0-9])(\\:[0-5][0-9]){1,2}$/.test(String(value));\r\n}\r\n","export function selfFactory(dependency?: any) {\r\n  return dependency;\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  Input,\r\n  Optional,\r\n  SkipSelf,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { ControlContainer } from '@angular/forms';\r\nimport {\r\n  NgbDateAdapter,\r\n  NgbInputDatepicker,\r\n  NgbTimeAdapter,\r\n  NgbTimepicker,\r\n} from '@ng-bootstrap/ng-bootstrap';\r\nimport { DateTimeAdapter } from '../../adapters/date-time.adapter';\r\nimport { FormProp } from '../../models/form-props';\r\nimport { selfFactory } from '../../utils/factory.util';\r\n\r\n@Component({\r\n  exportAs: 'abpDateTimePicker',\r\n  selector: 'abp-date-time-picker',\r\n  template: `\r\n    <input\r\n      [id]=\"prop.id\"\r\n      [formControlName]=\"prop.name\"\r\n      (ngModelChange)=\"setTime($event)\"\r\n      (click)=\"datepicker.open()\"\r\n      (keyup.space)=\"datepicker.open()\"\r\n      ngbDatepicker\r\n      #datepicker=\"ngbDatepicker\"\r\n      type=\"text\"\r\n      class=\"form-control\"\r\n    />\r\n    <ngb-timepicker\r\n      #timepicker\r\n      [formControlName]=\"prop.name\"\r\n      (ngModelChange)=\"setDate($event)\"\r\n    ></ngb-timepicker>\r\n  `,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  viewProviders: [\r\n    {\r\n      provide: ControlContainer,\r\n      useFactory: selfFactory,\r\n      deps: [[new Optional(), new SkipSelf(), ControlContainer]],\r\n    },\r\n    {\r\n      provide: NgbDateAdapter,\r\n      useClass: DateTimeAdapter,\r\n    },\r\n    {\r\n      provide: NgbTimeAdapter,\r\n      useClass: DateTimeAdapter,\r\n    },\r\n  ],\r\n})\r\nexport class DateTimePickerComponent {\r\n  @Input() prop: FormProp;\r\n\r\n  @ViewChild(NgbInputDatepicker) date: NgbInputDatepicker;\r\n  @ViewChild(NgbTimepicker) time: NgbTimepicker;\r\n\r\n  constructor(public readonly cdRef: ChangeDetectorRef) {}\r\n\r\n  setDate(datestr: string) {\r\n    this.date.writeValue(datestr);\r\n  }\r\n\r\n  setTime(datestr: string) {\r\n    this.time.writeValue(datestr);\r\n  }\r\n}\r\n","import { ABP, TrackByService } from '@abp/ng.core';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  Input,\r\n  Optional,\r\n  SimpleChanges,\r\n  SkipSelf,\r\n  OnChanges,\r\n} from '@angular/core';\r\nimport { ControlContainer, Validators, ValidatorFn } from '@angular/forms';\r\nimport { NgbDateAdapter, NgbTimeAdapter } from '@ng-bootstrap/ng-bootstrap';\r\nimport { Observable, of } from 'rxjs';\r\nimport { DateAdapter } from '../../adapters/date.adapter';\r\nimport { TimeAdapter } from '../../adapters/time.adapter';\r\nimport { ePropType } from '../../enums/props.enum';\r\nimport { FormProp } from '../../models/form-props';\r\nimport { PropData } from '../../models/props';\r\nimport { selfFactory } from '../../utils/factory.util';\r\n\r\n@Component({\r\n  selector: 'abp-extensible-form-prop',\r\n  templateUrl: './extensible-form-prop.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  viewProviders: [\r\n    {\r\n      provide: ControlContainer,\r\n      useFactory: selfFactory,\r\n      deps: [[new Optional(), new SkipSelf(), ControlContainer]],\r\n    },\r\n    { provide: NgbDateAdapter, useClass: DateAdapter },\r\n    { provide: NgbTimeAdapter, useClass: TimeAdapter },\r\n  ],\r\n})\r\nexport class ExtensibleFormPropComponent implements OnChanges {\r\n  @Input() data: PropData;\r\n\r\n  @Input() prop: FormProp;\r\n\r\n  options$: Observable<ABP.Option<any>[]> = of([]);\r\n\r\n  validators: ValidatorFn[] = [];\r\n\r\n  readonly: boolean;\r\n\r\n  disabled: boolean;\r\n\r\n  constructor(public readonly cdRef: ChangeDetectorRef, public readonly track: TrackByService) {}\r\n\r\n  get asterisk(): string {\r\n    return this.validators.some(validator => validator === Validators.required) ? '*' : '';\r\n  }\r\n\r\n  getComponent(prop: FormProp): string {\r\n    if (prop.options) return 'select';\r\n\r\n    switch (prop.type) {\r\n      case ePropType.Boolean:\r\n        return 'checkbox';\r\n      case ePropType.Date:\r\n        return 'date';\r\n      case ePropType.DateTime:\r\n        return 'dateTime';\r\n      case ePropType.Text:\r\n        return 'textarea';\r\n      case ePropType.Time:\r\n        return 'time';\r\n      default:\r\n        return 'input';\r\n    }\r\n  }\r\n\r\n  getType(prop: FormProp): string {\r\n    switch (prop.type) {\r\n      case ePropType.Date:\r\n      case ePropType.String:\r\n        return 'text';\r\n      case ePropType.Boolean:\r\n        return 'checkbox';\r\n      case ePropType.Number:\r\n        return 'number';\r\n      case ePropType.Email:\r\n        return 'email';\r\n      case ePropType.Password:\r\n        return 'password';\r\n      default:\r\n        return 'hidden';\r\n    }\r\n  }\r\n\r\n  ngOnChanges({ prop }: SimpleChanges) {\r\n    const options = prop.currentValue.options;\r\n    const readonly = prop.currentValue.readonly;\r\n    const disabled = prop.currentValue.disabled;\r\n    const validators = prop.currentValue.validators;\r\n\r\n    if (options) this.options$ = options(this.data);\r\n    if (readonly) this.readonly = readonly(this.data);\r\n    if (disabled) this.disabled = disabled(this.data);\r\n    if (validators) this.validators = validators(this.data);\r\n  }\r\n}\r\n","export const EXTRA_PROPERTIES_KEY = 'extraProperties';\r\n","/* tslint:disable:variable-name */\r\nimport { LinkedList } from '@abp/utils';\r\nimport { InjectFlags, InjectionToken, Type } from '@angular/core';\r\nimport { O } from 'ts-toolbelt';\r\n\r\nexport abstract class ActionList<R = any, A = Action<R>> extends LinkedList<A> {}\r\n\r\nexport abstract class ActionData<R = any> {\r\n  abstract getInjected: <T>(\r\n    token: Type<T> | InjectionToken<T>,\r\n    notFoundValue?: T,\r\n    flags?: InjectFlags,\r\n  ) => T;\r\n  index?: number;\r\n  abstract record: R;\r\n\r\n  get data(): ReadonlyActionData<R> {\r\n    return {\r\n      getInjected: this.getInjected,\r\n      index: this.index,\r\n      record: this.record,\r\n    };\r\n  }\r\n}\r\n\r\nexport type ReadonlyActionData<R = any> = O.Readonly<Omit<ActionData<R>, 'data'>>;\r\n\r\nexport abstract class Action<R = any> {\r\n  constructor(\r\n    public readonly permission: string,\r\n    public readonly visible: ActionPredicate<R> = _ => true,\r\n    public readonly action: ActionCallback<R> = _ => {},\r\n  ) {}\r\n}\r\n\r\nexport type ActionCallback<T, R = any> = (data?: Omit<ActionData<T>, 'data'>) => R;\r\nexport type ActionPredicate<T> = (data?: Omit<ActionData<T>, 'data'>) => boolean;\r\n\r\nexport abstract class ActionsFactory<C extends Actions<any>> {\r\n  protected abstract _ctor: Type<C>;\r\n  private contributorCallbacks: ActionContributorCallbacks<InferredActionList<C>> = {};\r\n\r\n  get(name: string): C {\r\n    this.contributorCallbacks[name] = this.contributorCallbacks[name] || [];\r\n\r\n    return new this._ctor(this.contributorCallbacks[name]);\r\n  }\r\n}\r\n\r\nexport abstract class Actions<L extends ActionList> {\r\n  protected abstract _ctor: Type<L>;\r\n\r\n  get actions(): L {\r\n    const actionList = new this._ctor();\r\n\r\n    this.callbackList.forEach(callback => callback(actionList));\r\n\r\n    return actionList;\r\n  }\r\n\r\n  constructor(private readonly callbackList: ActionContributorCallback<L>[]) {}\r\n\r\n  addContributor(contributeCallback: ActionContributorCallback<L>) {\r\n    this.callbackList.push(contributeCallback);\r\n  }\r\n\r\n  clearContributors() {\r\n    while (this.callbackList.length) this.callbackList.pop();\r\n  }\r\n}\r\n\r\nexport type ActionContributorCallbacks<L extends ActionList<any>> = Record<\r\n  string,\r\n  ActionContributorCallback<L>[]\r\n>;\r\n\r\nexport type ActionContributorCallback<L extends ActionList<any>> = (actionList: L) => any;\r\n\r\ntype InferredActionList<C> = C extends Actions<infer L> ? L : never;\r\n","/* tslint:disable:variable-name */\r\nimport { Type } from '@angular/core';\r\nimport { O } from 'ts-toolbelt';\r\nimport {\r\n  Action,\r\n  ActionContributorCallback,\r\n  ActionContributorCallbacks,\r\n  ActionList,\r\n  Actions,\r\n  ActionsFactory,\r\n} from './actions';\r\n\r\nexport class EntityActionList<R = any> extends ActionList<R, EntityAction<R>> {}\r\n\r\nexport class EntityActions<R = any> extends Actions<EntityActionList<R>> {\r\n  protected _ctor: Type<EntityActionList<R>> = EntityActionList;\r\n}\r\n\r\nexport class EntityActionsFactory<R = any> extends ActionsFactory<EntityActions<R>> {\r\n  protected _ctor: Type<EntityActions<R>> = EntityActions;\r\n}\r\n\r\nexport class EntityAction<R = any> extends Action<R> {\r\n  readonly text: string;\r\n  readonly icon: string;\r\n\r\n  constructor(options: EntityActionOptions<R>) {\r\n    super(options.permission, options.visible, options.action);\r\n    this.text = options.text;\r\n    this.icon = options.icon || '';\r\n  }\r\n\r\n  static create<R = any>(options: EntityActionOptions<R>) {\r\n    return new EntityAction<R>(options);\r\n  }\r\n\r\n  static createMany<R = any>(arrayOfOptions: EntityActionOptions<R>[]) {\r\n    return arrayOfOptions.map(EntityAction.create);\r\n  }\r\n}\r\n\r\nexport type EntityActionOptions<R = any> = O.Optional<\r\n  O.Writable<EntityAction<R>>,\r\n  'permission' | 'visible' | 'icon'\r\n>;\r\n\r\nexport type EntityActionDefaults<R = any> = Record<string, EntityAction<R>[]>;\r\nexport type EntityActionContributorCallback<R = any> = ActionContributorCallback<\r\n  EntityActionList<R>\r\n>;\r\nexport type EntityActionContributorCallbacks<R = any> = ActionContributorCallbacks<\r\n  EntityActionList<R>\r\n>;\r\n","/* tslint:disable:variable-name */\r\nimport { LinkedList } from '@abp/utils';\r\nimport { InjectFlags, InjectionToken, Type } from '@angular/core';\r\nimport { O } from 'ts-toolbelt';\r\nimport { ePropType } from '../enums/props.enum';\r\n\r\nexport abstract class PropList<R = any, A = Prop<R>> extends LinkedList<A> {}\r\n\r\nexport abstract class PropData<R = any> {\r\n  abstract getInjected: <T>(\r\n    token: Type<T> | InjectionToken<T>,\r\n    notFoundValue?: T,\r\n    flags?: InjectFlags,\r\n  ) => T;\r\n  index?: number;\r\n  abstract record: R;\r\n\r\n  get data(): ReadonlyPropData<R> {\r\n    return {\r\n      getInjected: this.getInjected,\r\n      index: this.index,\r\n      record: this.record,\r\n    };\r\n  }\r\n}\r\n\r\nexport type ReadonlyPropData<R = any> = O.Readonly<Omit<PropData<R>, 'data'>>;\r\n\r\nexport abstract class Prop<R = any> {\r\n  constructor(\r\n    public readonly type: ePropType,\r\n    public readonly name: string,\r\n    public readonly displayName: string,\r\n    public readonly permission: string,\r\n    public readonly visible: PropPredicate<R> = _ => true,\r\n    public readonly isExtra = false,\r\n  ) {\r\n    this.displayName = this.displayName || this.name;\r\n  }\r\n}\r\n\r\nexport type PropCallback<T, R = any> = (data?: Omit<PropData<T>, 'data'>) => R;\r\nexport type PropPredicate<T> = (data?: Omit<PropData<T>, 'data'>) => boolean;\r\n\r\nexport abstract class PropsFactory<C extends Props<any>> {\r\n  protected abstract _ctor: Type<C>;\r\n  private contributorCallbacks: PropContributorCallbacks<InferredPropList<C>> = {};\r\n\r\n  get(name: string): C {\r\n    this.contributorCallbacks[name] = this.contributorCallbacks[name] || [];\r\n\r\n    return new this._ctor(this.contributorCallbacks[name]);\r\n  }\r\n}\r\n\r\nexport abstract class Props<L extends PropList> {\r\n  protected abstract _ctor: Type<L>;\r\n\r\n  get props(): L {\r\n    const propList = new this._ctor();\r\n\r\n    this.callbackList.forEach(callback => callback(propList));\r\n\r\n    return propList;\r\n  }\r\n\r\n  constructor(private readonly callbackList: PropContributorCallback<L>[]) {}\r\n\r\n  addContributor(contributeCallback: PropContributorCallback<L>) {\r\n    this.callbackList.push(contributeCallback);\r\n  }\r\n\r\n  clearContributors() {\r\n    while (this.callbackList.length) this.callbackList.pop();\r\n  }\r\n}\r\n\r\nexport type PropContributorCallbacks<L extends PropList<any>> = Record<\r\n  string,\r\n  PropContributorCallback<L>[]\r\n>;\r\n\r\nexport type PropContributorCallback<L extends PropList<any>> = (propList: L) => any;\r\n\r\ntype InferredPropList<C> = C extends Props<infer L> ? L : never;\r\n","/* tslint:disable:variable-name */\r\nimport { Type } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { O } from 'ts-toolbelt';\r\nimport {\r\n  Prop,\r\n  PropCallback,\r\n  PropContributorCallback,\r\n  PropContributorCallbacks,\r\n  PropList,\r\n  Props,\r\n  PropsFactory,\r\n} from './props';\r\nimport { ActionCallback } from './actions';\r\n\r\nexport class EntityPropList<R = any> extends PropList<R, EntityProp<R>> {}\r\n\r\nexport class EntityProps<R = any> extends Props<EntityPropList<R>> {\r\n  protected _ctor: Type<EntityPropList<R>> = EntityPropList;\r\n}\r\n\r\nexport class EntityPropsFactory<R = any> extends PropsFactory<EntityProps<R>> {\r\n  protected _ctor: Type<EntityProps<R>> = EntityProps;\r\n}\r\n\r\nexport class EntityProp<R = any> extends Prop<R> {\r\n  readonly columnWidth: number | undefined;\r\n  readonly sortable: boolean;\r\n  readonly valueResolver: PropCallback<R, Observable<any>>;\r\n  readonly action: ActionCallback<R>;\r\n\r\n  constructor(options: EntityPropOptions<R>) {\r\n    super(\r\n      options.type,\r\n      options.name,\r\n      options.displayName,\r\n      options.permission,\r\n      options.visible,\r\n      options.isExtra,\r\n    );\r\n\r\n    this.columnWidth = options.columnWidth;\r\n    this.sortable = options.sortable || false;\r\n    this.valueResolver = options.valueResolver || (data => of(data.record[this.name]));\r\n    this.action = options.action;\r\n  }\r\n\r\n  static create<R = any>(options: EntityPropOptions<R>) {\r\n    return new EntityProp<R>(options);\r\n  }\r\n\r\n  static createMany<R = any>(arrayOfOptions: EntityPropOptions<R>[]) {\r\n    return arrayOfOptions.map(EntityProp.create);\r\n  }\r\n}\r\n\r\nexport type EntityPropOptions<R = any> = O.Optional<\r\n  O.Writable<EntityProp<R>>,\r\n  | 'permission'\r\n  | 'visible'\r\n  | 'displayName'\r\n  | 'isExtra'\r\n  | 'columnWidth'\r\n  | 'sortable'\r\n  | 'valueResolver'\r\n  | 'action'\r\n>;\r\n\r\nexport type EntityPropDefaults<R = any> = Record<string, EntityProp<R>[]>;\r\nexport type EntityPropContributorCallback<R = any> = PropContributorCallback<EntityPropList<R>>;\r\nexport type EntityPropContributorCallbacks<R = any> = PropContributorCallbacks<EntityPropList<R>>;\r\n","/* tslint:disable:variable-name */\r\nimport { ABP } from '@abp/ng.core';\r\nimport { Injector, Type } from '@angular/core';\r\nimport { AsyncValidatorFn, ValidatorFn } from '@angular/forms';\r\nimport { Observable } from 'rxjs';\r\nimport { O } from 'ts-toolbelt';\r\nimport {\r\n  Prop,\r\n  PropCallback,\r\n  PropContributorCallback,\r\n  PropContributorCallbacks,\r\n  PropData,\r\n  PropList,\r\n  PropPredicate,\r\n  Props,\r\n  PropsFactory,\r\n} from './props';\r\n\r\nexport class FormPropList<R = any> extends PropList<R, FormProp<R>> {}\r\n\r\nexport class FormProps<R = any> extends Props<FormPropList<R>> {\r\n  protected _ctor: Type<FormPropList<R>> = FormPropList;\r\n}\r\n\r\nexport class CreateFormPropsFactory<R = any> extends PropsFactory<FormProps<R>> {\r\n  protected _ctor: Type<FormProps<R>> = FormProps;\r\n}\r\n\r\nexport class EditFormPropsFactory<R = any> extends PropsFactory<FormProps<R>> {\r\n  protected _ctor: Type<FormProps<R>> = FormProps;\r\n}\r\n\r\nexport class FormProp<R = any> extends Prop<R> {\r\n  readonly validators: PropCallback<R, ValidatorFn[]>;\r\n  readonly asyncValidators: PropCallback<R, AsyncValidatorFn[]>;\r\n  readonly disabled: PropPredicate<R>;\r\n  readonly readonly: PropPredicate<R>;\r\n  readonly autocomplete: string;\r\n  readonly defaultValue: boolean | number | string | Date;\r\n  readonly options: PropCallback<R, Observable<ABP.Option<any>[]>> | undefined;\r\n  readonly id: string | undefined;\r\n\r\n  constructor(options: FormPropOptions<R>) {\r\n    super(\r\n      options.type,\r\n      options.name,\r\n      options.displayName,\r\n      options.permission,\r\n      options.visible,\r\n      options.isExtra,\r\n    );\r\n\r\n    this.asyncValidators = options.asyncValidators || (_ => []);\r\n    this.validators = options.validators || (_ => []);\r\n    this.disabled = options.disabled || (_ => false);\r\n    this.readonly = options.readonly || (_ => false);\r\n    this.autocomplete = options.autocomplete || 'off';\r\n    this.options = options.options;\r\n    this.id = options.id || options.name;\r\n    const defaultValue = options.defaultValue;\r\n    this.defaultValue = isFalsyValue(defaultValue) ? defaultValue : defaultValue || null;\r\n  }\r\n\r\n  static create<R = any>(options: FormPropOptions<R>) {\r\n    return new FormProp<R>(options);\r\n  }\r\n\r\n  static createMany<R = any>(arrayOfOptions: FormPropOptions<R>[]) {\r\n    return arrayOfOptions.map(FormProp.create);\r\n  }\r\n}\r\n\r\nexport class FormPropData<R = any> extends PropData<R> {\r\n  getInjected: PropData<R>['getInjected'];\r\n\r\n  constructor(injector: Injector, public readonly record: R) {\r\n    super();\r\n\r\n    // tslint:disable-next-line\r\n    this.getInjected = injector.get.bind(injector);\r\n  }\r\n}\r\n\r\nexport type FormPropOptions<R = any> = O.Optional<\r\n  O.Writable<FormProp<R>>,\r\n  | 'permission'\r\n  | 'visible'\r\n  | 'displayName'\r\n  | 'isExtra'\r\n  | 'validators'\r\n  | 'asyncValidators'\r\n  | 'disabled'\r\n  | 'readonly'\r\n  | 'autocomplete'\r\n  | 'defaultValue'\r\n  | 'options'\r\n  | 'id'\r\n>;\r\n\r\nexport type CreateFormPropDefaults<R = any> = Record<string, FormProp<R>[]>;\r\nexport type CreateFormPropContributorCallback<R = any> = PropContributorCallback<FormPropList<R>>;\r\nexport type CreateFormPropContributorCallbacks<R = any> = PropContributorCallbacks<FormPropList<R>>;\r\nexport type EditFormPropDefaults<R = any> = Record<string, FormProp<R>[]>;\r\nexport type EditFormPropContributorCallback<R = any> = PropContributorCallback<FormPropList<R>>;\r\nexport type EditFormPropContributorCallbacks<R = any> = PropContributorCallbacks<FormPropList<R>>;\r\n\r\nfunction isFalsyValue(defaultValue: FormProp['defaultValue']): boolean {\r\n  return [0, '', false].indexOf(defaultValue as any) > -1;\r\n}\r\n","/* tslint:disable:variable-name */\r\nimport { Type } from '@angular/core';\r\nimport { O } from 'ts-toolbelt';\r\nimport {\r\n  Action,\r\n  ActionContributorCallback,\r\n  ActionContributorCallbacks,\r\n  ActionList,\r\n  Actions,\r\n  ActionsFactory,\r\n} from './actions';\r\n\r\nexport class ToolbarActionList<R = any> extends ActionList<\r\n  R,\r\n  ToolbarAction<R> | ToolbarComponent<R>\r\n> {}\r\n\r\nexport class ToolbarActions<R = any> extends Actions<ToolbarActionList<R>> {\r\n  protected _ctor: Type<ToolbarActionList<R>> = ToolbarActionList;\r\n}\r\n\r\nexport class ToolbarActionsFactory<R = any> extends ActionsFactory<ToolbarActions<R>> {\r\n  protected _ctor: Type<ToolbarActions<R>> = ToolbarActions;\r\n}\r\n\r\nexport class ToolbarAction<R = any> extends Action<R> {\r\n  readonly text: string;\r\n  readonly icon: string;\r\n\r\n  constructor(options: ToolbarActionOptions<R>) {\r\n    super(options.permission, options.visible, options.action);\r\n    this.text = options.text;\r\n    this.icon = options.icon || '';\r\n  }\r\n\r\n  static create<R = any>(options: ToolbarActionOptions<R>) {\r\n    return new ToolbarAction<R>(options);\r\n  }\r\n\r\n  static createMany<R = any>(arrayOfOptions: ToolbarActionOptions<R>[]) {\r\n    return arrayOfOptions.map(ToolbarAction.create);\r\n  }\r\n}\r\n\r\nexport class ToolbarComponent<R = any> extends Action<R> {\r\n  readonly component: Type<any>;\r\n\r\n  constructor(options: ToolbarComponentOptions<R>) {\r\n    super(options.permission, options.visible, options.action);\r\n    this.component = options.component;\r\n  }\r\n\r\n  static create<R = any>(options: ToolbarComponentOptions<R>) {\r\n    return new ToolbarComponent<R>(options);\r\n  }\r\n\r\n  static createMany<R = any>(arrayOfOptions: ToolbarComponentOptions<R>[]) {\r\n    return arrayOfOptions.map(ToolbarComponent.create);\r\n  }\r\n}\r\n\r\nexport type ToolbarActionOptions<R = any> = O.Optional<\r\n  O.Writable<ToolbarAction<R>>,\r\n  'permission' | 'visible' | 'icon'\r\n>;\r\n\r\nexport type ToolbarComponentOptions<R = any> = O.Optional<\r\n  O.Writable<ToolbarComponent<R>>,\r\n  'permission' | 'visible' | 'action'\r\n>;\r\n\r\nexport type ToolbarActionDefaults<R = any> = Record<string, ToolbarAction<R>[]>;\r\nexport type ToolbarActionContributorCallback<R = any> = ActionContributorCallback<\r\n  ToolbarActionList<R>\r\n>;\r\nexport type ToolbarActionContributorCallbacks<R = any> = ActionContributorCallbacks<\r\n  ToolbarActionList<R>\r\n>;\r\n","import { Injectable } from '@angular/core';\r\nimport { EntityActionsFactory } from '../models/entity-actions';\r\nimport { EntityPropsFactory } from '../models/entity-props';\r\nimport { CreateFormPropsFactory, EditFormPropsFactory } from '../models/form-props';\r\nimport { ToolbarActionsFactory } from '../models/toolbar-actions';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ExtensionsService<R = any> {\r\n  readonly entityActions = new EntityActionsFactory<R>();\r\n  readonly toolbarActions = new ToolbarActionsFactory<R[]>();\r\n  readonly entityProps = new EntityPropsFactory<R>();\r\n  readonly createFormProps = new CreateFormPropsFactory<R>();\r\n  readonly editFormProps = new EditFormPropsFactory<R>();\r\n}\r\n","import { InjectionToken } from '@angular/core';\r\nimport { ActionCallback, ReadonlyActionData as ActionData } from '../models/actions';\r\nimport { ExtensionsService } from '../services/extensions.service';\r\n\r\nexport const EXTENSIONS_IDENTIFIER = new InjectionToken<string>('EXTENSIONS_IDENTIFIER');\r\nexport type ActionKeys = Extract<'entityActions' | 'toolbarActions', keyof ExtensionsService>;\r\n\r\nexport const EXTENSIONS_ACTION_TYPE = new InjectionToken<ActionKeys>('EXTENSIONS_ACTION_TYPE');\r\n\r\nexport const EXTENSIONS_ACTION_DATA = new InjectionToken<ActionData>('EXTENSIONS_ACTION_DATA');\r\nexport const EXTENSIONS_ACTION_CALLBACK = new InjectionToken<ActionCallback<unknown>>(\r\n  'EXTENSIONS_ACTION_DATA',\r\n);\r\n","import { TrackByService } from '@abp/ng.core';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  Inject,\r\n  Input,\r\n  Optional,\r\n  QueryList,\r\n  SkipSelf,\r\n  ViewChildren,\r\n} from '@angular/core';\r\nimport { ControlContainer, FormGroup } from '@angular/forms';\r\nimport { EXTRA_PROPERTIES_KEY } from '../../constants/extra-properties';\r\nimport { FormPropList } from '../../models/form-props';\r\nimport { ExtensionsService } from '../../services/extensions.service';\r\nimport { EXTENSIONS_IDENTIFIER } from '../../tokens/extensions.token';\r\nimport { selfFactory } from '../../utils/factory.util';\r\nimport { ExtensibleFormPropComponent } from './extensible-form-prop.component';\r\n\r\n@Component({\r\n  exportAs: 'abpExtensibleForm',\r\n  selector: 'abp-extensible-form',\r\n  templateUrl: './extensible-form.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  viewProviders: [\r\n    {\r\n      provide: ControlContainer,\r\n      useFactory: selfFactory,\r\n      deps: [[new Optional(), new SkipSelf(), ControlContainer]],\r\n    },\r\n  ],\r\n})\r\nexport class ExtensibleFormComponent<R = any> {\r\n  @ViewChildren(ExtensibleFormPropComponent)\r\n  formProps: QueryList<ExtensibleFormPropComponent>;\r\n\r\n  @Input()\r\n  set selectedRecord(record: R) {\r\n    const type = !record || JSON.stringify(record) === '{}' ? 'create' : 'edit';\r\n    this.propList = this.extensions[`${type}FormProps`].get(this.identifier).props;\r\n    this.record = record;\r\n  }\r\n\r\n  extraPropertiesKey = EXTRA_PROPERTIES_KEY;\r\n  propList: FormPropList<R>;\r\n  record: R;\r\n\r\n  get form(): FormGroup {\r\n    return (this.container ? this.container.control : { controls: {} }) as FormGroup;\r\n  }\r\n\r\n  get extraProperties(): FormGroup {\r\n    return (this.form.controls.extraProperties || { controls: {} }) as FormGroup;\r\n  }\r\n\r\n  constructor(\r\n    public readonly cdRef: ChangeDetectorRef,\r\n    public readonly track: TrackByService,\r\n    private container: ControlContainer,\r\n    private extensions: ExtensionsService,\r\n    @Inject(EXTENSIONS_IDENTIFIER) private identifier: string,\r\n  ) {}\r\n}\r\n","import {\r\n  ListService,\r\n  ConfigStateService,\r\n  getShortDateFormat,\r\n  getShortDateShortTimeFormat,\r\n  getShortTimeFormat,\r\n} from '@abp/ng.core';\r\nimport { formatDate } from '@angular/common';\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Inject,\r\n  Injector,\r\n  Input,\r\n  LOCALE_ID,\r\n  TemplateRef,\r\n  TrackByFunction,\r\n  Type,\r\n  InjectionToken,\r\n  InjectFlags,\r\n  SimpleChanges,\r\n  OnChanges,\r\n} from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { ePropType } from '../../enums/props.enum';\r\nimport { EntityProp, EntityPropList } from '../../models/entity-props';\r\nimport { PropData } from '../../models/props';\r\nimport { ExtensionsService } from '../../services/extensions.service';\r\nimport { EXTENSIONS_IDENTIFIER } from '../../tokens/extensions.token';\r\nimport { EntityActionList } from '../../models/entity-actions';\r\nconst DEFAULT_ACTIONS_COLUMN_WIDTH = 150;\r\n\r\n@Component({\r\n  exportAs: 'abpExtensibleTable',\r\n  selector: 'abp-extensible-table',\r\n  templateUrl: './extensible-table.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ExtensibleTableComponent<R = any> implements OnChanges {\r\n  protected _actionsText: string;\r\n  @Input()\r\n  set actionsText(value: string) {\r\n    this._actionsText = value;\r\n  }\r\n  get actionsText(): string {\r\n    return this._actionsText ?? (this.actionList.length > 1 ? 'AbpUi::Actions' : '');\r\n  }\r\n\r\n  @Input() data: R[];\r\n  @Input() list: ListService;\r\n  @Input() recordsTotal: number;\r\n  @Input() set actionsColumnWidth(width: number) {\r\n    this.setColumnWidths(width ? Number(width) : undefined);\r\n  }\r\n  @Input() actionsTemplate: TemplateRef<any>;\r\n\r\n  getInjected: <T>(token: Type<T> | InjectionToken<T>, notFoundValue?: T, flags?: InjectFlags) => T;\r\n\r\n  readonly columnWidths: number[];\r\n\r\n  readonly propList: EntityPropList<R>;\r\n\r\n  readonly actionList: EntityActionList<R>;\r\n\r\n  readonly trackByFn: TrackByFunction<EntityProp<R>> = (_, item) => item.name;\r\n\r\n  constructor(\r\n    @Inject(LOCALE_ID) private locale: string,\r\n    private config: ConfigStateService,\r\n    injector: Injector,\r\n  ) {\r\n    // tslint:disable-next-line\r\n    this.getInjected = injector.get.bind(injector);\r\n    const extensions = injector.get(ExtensionsService);\r\n    const name = injector.get(EXTENSIONS_IDENTIFIER);\r\n    this.propList = extensions.entityProps.get(name).props;\r\n    this.actionList = (extensions['entityActions'].get(name)\r\n      .actions as unknown) as EntityActionList<R>;\r\n    this.setColumnWidths(DEFAULT_ACTIONS_COLUMN_WIDTH);\r\n  }\r\n\r\n  private setColumnWidths(actionsColumn: number) {\r\n    const widths = [actionsColumn];\r\n    this.propList.forEach(({ value: prop }) => {\r\n      widths.push(prop.columnWidth);\r\n    });\r\n    (this.columnWidths as any) = widths;\r\n  }\r\n\r\n  private getDate(value: Date, format: string) {\r\n    return value ? formatDate(value, format, this.locale) : '';\r\n  }\r\n\r\n  private getIcon(value: boolean) {\r\n    return value\r\n      ? '<div class=\"text-center text-success\"><i class=\"fa fa-check\"></i></div>'\r\n      : '<div class=\"text-center text-danger\"><i class=\"fa fa-times\"></i></div>';\r\n  }\r\n\r\n  getContent(prop: EntityProp<R>, data: PropData): Observable<string> {\r\n    return prop.valueResolver(data).pipe(\r\n      map(value => {\r\n        switch (prop.type) {\r\n          case ePropType.Boolean:\r\n            return this.getIcon(value);\r\n          case ePropType.Date:\r\n            return this.getDate(value, getShortDateFormat(this.config));\r\n          case ePropType.Time:\r\n            return this.getDate(value, getShortTimeFormat(this.config));\r\n          case ePropType.DateTime:\r\n            return this.getDate(value, getShortDateShortTimeFormat(this.config));\r\n          default:\r\n            return value;\r\n          // More types can be handled in the future\r\n        }\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnChanges({ data }: SimpleChanges) {\r\n    if (!data?.currentValue) return;\r\n\r\n    this.data = data.currentValue.map((record, index) => {\r\n      this.propList.forEach(prop => {\r\n        const propData = { getInjected: this.getInjected, record, index } as any;\r\n        record[`_${prop.value.name}`] = {\r\n          visible: prop.value.visible(propData),\r\n          value: this.getContent(prop.value, propData),\r\n        };\r\n      });\r\n\r\n      return record;\r\n    });\r\n  }\r\n}\r\n","import { Directive, Injector, Input } from '@angular/core';\r\nimport { ActionData, ActionList } from '../../models/actions';\r\nimport { ExtensionsService } from '../../services/extensions.service';\r\nimport { EXTENSIONS_ACTION_TYPE, EXTENSIONS_IDENTIFIER } from '../../tokens/extensions.token';\r\n\r\n// tslint:disable: directive-class-suffix\r\n// Fix for https://github.com/angular/angular/issues/23904\r\n// @dynamic\r\n@Directive()\r\nexport abstract class AbstractActionsComponent<L extends ActionList<any>> extends ActionData<\r\n  InferredRecord<L>\r\n> {\r\n  readonly actionList: L;\r\n\r\n  readonly getInjected: InferredData<L>['getInjected'];\r\n\r\n  @Input() readonly record: InferredData<L>['record'];\r\n\r\n  constructor(injector: Injector) {\r\n    super();\r\n\r\n    // tslint:disable-next-line\r\n    this.getInjected = injector.get.bind(injector);\r\n    const extensions = injector.get(ExtensionsService);\r\n    const name = injector.get(EXTENSIONS_IDENTIFIER);\r\n    const type = injector.get(EXTENSIONS_ACTION_TYPE);\r\n    this.actionList = (extensions[type].get(name).actions as unknown) as L;\r\n  }\r\n}\r\n\r\ntype InferredData<L> = ActionData<InferredRecord<L>>;\r\ntype InferredRecord<L> = L extends ActionList<infer R> ? R : never;\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Injector,\r\n  Input,\r\n  TrackByFunction,\r\n} from '@angular/core';\r\nimport { EntityAction, EntityActionList } from '../../models/entity-actions';\r\nimport { EXTENSIONS_ACTION_TYPE } from '../../tokens/extensions.token';\r\nimport { AbstractActionsComponent } from '../abstract-actions/abstract-actions.component';\r\n\r\n@Component({\r\n  exportAs: 'abpGridActions',\r\n  selector: 'abp-grid-actions',\r\n  templateUrl: './grid-actions.component.html',\r\n  providers: [\r\n    {\r\n      provide: EXTENSIONS_ACTION_TYPE,\r\n      useValue: 'entityActions',\r\n    },\r\n  ],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class GridActionsComponent<R = any> extends AbstractActionsComponent<EntityActionList<R>> {\r\n  @Input() icon = 'fa fa-cog';\r\n\r\n  @Input() readonly index: number;\r\n\r\n  @Input() text = '';\r\n\r\n  readonly trackByFn: TrackByFunction<EntityAction<R>> = (_, item) => item.text;\r\n\r\n  constructor(injector: Injector) {\r\n    super(injector);\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  InjectFlags,\r\n  InjectionToken,\r\n  Injector,\r\n  TrackByFunction,\r\n  Type,\r\n} from '@angular/core';\r\nimport { ToolbarActionList, ToolbarComponent } from '../../models/toolbar-actions';\r\nimport {\r\n  EXTENSIONS_ACTION_CALLBACK,\r\n  EXTENSIONS_ACTION_DATA,\r\n  EXTENSIONS_ACTION_TYPE,\r\n} from '../../tokens/extensions.token';\r\nimport { AbstractActionsComponent } from '../abstract-actions/abstract-actions.component';\r\n\r\n@Component({\r\n  exportAs: 'abpPageToolbar',\r\n  selector: 'abp-page-toolbar',\r\n  templateUrl: './page-toolbar.component.html',\r\n  providers: [\r\n    {\r\n      provide: EXTENSIONS_ACTION_TYPE,\r\n      useValue: 'toolbarActions',\r\n    },\r\n  ],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class PageToolbarComponent<R = any> extends AbstractActionsComponent<ToolbarActionList<R>> {\r\n  readonly trackByFn: TrackByFunction<ToolbarComponent<R>> = (_, item) =>\r\n    item.action || item.component;\r\n\r\n  constructor(private readonly injector: Injector) {\r\n    super(injector);\r\n  }\r\n\r\n  createInjector(action: ToolbarComponent<R>): Injector {\r\n    const get = <T>(token: Type<T> | InjectionToken<T>, notFoundValue?: T, flags?: InjectFlags) => {\r\n      return token === EXTENSIONS_ACTION_DATA\r\n        ? this.data\r\n        : token === EXTENSIONS_ACTION_CALLBACK\r\n        ? (data = this.data) => action.action(data)\r\n        : this.getInjected.call(this.injector, token, notFoundValue, flags);\r\n    };\r\n\r\n    return { get };\r\n  }\r\n}\r\n","import { Directive, Host, Input, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { NgControl } from '@angular/forms';\r\n\r\n@Directive({\r\n  selector: '[abpDisabled]',\r\n})\r\nexport class DisabledDirective implements OnChanges {\r\n  @Input()\r\n  abpDisabled: boolean;\r\n\r\n  constructor(@Host() private ngControl: NgControl) {}\r\n\r\n  // Related issue: https://github.com/angular/angular/issues/35330\r\n  ngOnChanges({ abpDisabled }: SimpleChanges) {\r\n    if (this.ngControl.control && abpDisabled) {\r\n      this.ngControl.control[abpDisabled.currentValue ? 'disable' : 'enable']();\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  Injector,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  TemplateRef,\r\n  ViewContainerRef,\r\n} from '@angular/core';\r\nimport { PropData, PropList } from '../models/props';\r\n\r\n@Directive({\r\n  exportAs: 'abpPropData',\r\n  selector: '[abpPropData]',\r\n})\r\nexport class PropDataDirective<L extends PropList<any>> extends PropData<InferredData<L>>\r\n  implements OnChanges, OnDestroy {\r\n  /* tslint:disable:no-input-rename */\r\n  @Input('abpPropDataFromList') readonly propList: L;\r\n\r\n  @Input('abpPropDataWithRecord') readonly record: InferredData<L>['record'];\r\n\r\n  @Input('abpPropDataAtIndex') readonly index: number;\r\n  /* tslint:enable:no-input-rename */\r\n\r\n  readonly getInjected: InferredData<L>['getInjected'];\r\n\r\n  constructor(\r\n    private tempRef: TemplateRef<any>,\r\n    private vcRef: ViewContainerRef,\r\n    injector: Injector,\r\n  ) {\r\n    super();\r\n\r\n    // tslint:disable-next-line\r\n    this.getInjected = injector.get.bind(injector);\r\n  }\r\n\r\n  ngOnChanges() {\r\n    this.vcRef.clear();\r\n\r\n    this.vcRef.createEmbeddedView(this.tempRef, {\r\n      $implicit: this.data,\r\n      index: 0,\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.vcRef.clear();\r\n  }\r\n}\r\n\r\ntype InferredData<L> = PropData<InferredRecord<L>>;\r\ntype InferredRecord<L> = L extends PropList<infer R> ? R : never;\r\n","import { CoreModule } from '@abp/ng.core';\r\nimport { ThemeSharedModule } from '@abp/ng.theme.shared';\r\nimport { NgModule } from '@angular/core';\r\nimport {\r\n  NgbDatepickerModule,\r\n  NgbDropdownModule,\r\n  NgbTimepickerModule,\r\n} from '@ng-bootstrap/ng-bootstrap';\r\nimport { NgxValidateCoreModule } from '@ngx-validate/core';\r\nimport { DateTimePickerComponent } from './components/date-time-picker/date-time-picker.component';\r\nimport { ExtensibleFormPropComponent } from './components/extensible-form/extensible-form-prop.component';\r\nimport { ExtensibleFormComponent } from './components/extensible-form/extensible-form.component';\r\nimport { ExtensibleTableComponent } from './components/extensible-table/extensible-table.component';\r\nimport { GridActionsComponent } from './components/grid-actions/grid-actions.component';\r\nimport { PageToolbarComponent } from './components/page-toolbar/page-toolbar.component';\r\nimport { DisabledDirective } from './directives/disabled.directive';\r\nimport { PropDataDirective } from './directives/prop-data.directive';\r\n\r\n@NgModule({\r\n  exports: [\r\n    DateTimePickerComponent,\r\n    PageToolbarComponent,\r\n    GridActionsComponent,\r\n    ExtensibleFormComponent,\r\n    ExtensibleTableComponent,\r\n    PropDataDirective,\r\n    DisabledDirective,\r\n  ],\r\n  declarations: [\r\n    DateTimePickerComponent,\r\n    PageToolbarComponent,\r\n    GridActionsComponent,\r\n    ExtensibleFormPropComponent,\r\n    ExtensibleFormComponent,\r\n    ExtensibleTableComponent,\r\n    PropDataDirective,\r\n    DisabledDirective,\r\n  ],\r\n  imports: [\r\n    CoreModule,\r\n    ThemeSharedModule,\r\n    NgxValidateCoreModule,\r\n    NgbDatepickerModule,\r\n    NgbDropdownModule,\r\n    NgbTimepickerModule,\r\n  ],\r\n})\r\nexport class UiExtensionsModule {}\r\n","import { of } from 'rxjs';\r\nimport { EXTRA_PROPERTIES_KEY } from '../constants/extra-properties';\r\nimport {\r\n  EntityPropContributorCallbacks,\r\n  EntityPropDefaults,\r\n  EntityProps,\r\n  EntityPropsFactory,\r\n} from '../models/entity-props';\r\nimport {\r\n  CreateFormPropContributorCallbacks,\r\n  CreateFormPropDefaults,\r\n  CreateFormPropsFactory,\r\n  EditFormPropContributorCallbacks,\r\n  EditFormPropDefaults,\r\n  EditFormPropsFactory,\r\n  FormProps,\r\n} from '../models/form-props';\r\nimport { PropContributorCallback, PropData, PropList, PropsFactory } from '../models/props';\r\n\r\nexport function createExtraPropertyValueResolver<T>(name: string) {\r\n  return (data?: PropData<T>) => of(data.record[EXTRA_PROPERTIES_KEY][name]);\r\n}\r\n\r\nexport function mergeWithDefaultProps<F extends PropsFactory<any>>(\r\n  extension: F,\r\n  defaultProps: InferredPropDefaults<F>,\r\n  ...contributors: InferredPropContributorCallbacks<F>[]\r\n) {\r\n  Object.keys(defaultProps).forEach((name: string) => {\r\n    const props: InferredProps<F> = extension.get(name);\r\n    props.clearContributors();\r\n    props.addContributor((propList: PropList) => propList.addManyTail(defaultProps[name]));\r\n    contributors.forEach(contributor =>\r\n      (contributor[name] || []).forEach((callback: PropContributorCallback<any>) =>\r\n        props.addContributor(callback),\r\n      ),\r\n    );\r\n  });\r\n}\r\ntype InferredPropDefaults<F> = F extends EntityPropsFactory<infer RE>\r\n  ? EntityPropDefaults<RE>\r\n  : F extends CreateFormPropsFactory<infer RCF>\r\n  ? CreateFormPropDefaults<RCF>\r\n  : F extends EditFormPropsFactory<infer REF>\r\n  ? EditFormPropDefaults<REF>\r\n  : never;\r\n\r\ntype InferredPropContributorCallbacks<F> = F extends EntityPropsFactory<infer RE>\r\n  ? EntityPropContributorCallbacks<RE>\r\n  : F extends CreateFormPropsFactory<infer RCF>\r\n  ? CreateFormPropContributorCallbacks<RCF>\r\n  : F extends EditFormPropsFactory<infer REF>\r\n  ? EditFormPropContributorCallbacks<REF>\r\n  : never;\r\n\r\ntype InferredProps<F> = F extends EntityPropsFactory<infer RE>\r\n  ? EntityProps<RE>\r\n  : F extends CreateFormPropsFactory<infer RCF>\r\n  ? FormProps<RCF>\r\n  : F extends EditFormPropsFactory<infer REF>\r\n  ? FormProps<REF>\r\n  : never;\r\n","import { ABP, LocalizationService } from '@abp/ng.core';\r\nimport { merge, Observable, of } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { EXTRA_PROPERTIES_KEY } from '../constants/extra-properties';\r\nimport { ObjectExtensions } from '../models/object-extensions';\r\nimport { PropCallback } from '../models/props';\r\n\r\nexport function createEnum(members: ObjectExtensions.EnumMember[]) {\r\n  const enumObject: any = {};\r\n\r\n  members.forEach(({ name, value }) => {\r\n    enumObject[(enumObject[name] = value)] = name;\r\n  });\r\n\r\n  return enumObject;\r\n}\r\n\r\nexport function createEnumValueResolver<T = any>(\r\n  enumType: string,\r\n  lookupEnum: ObjectExtensions.Enum,\r\n  propName: string,\r\n): PropCallback<T, Observable<string>> {\r\n  return data => {\r\n    const value = data.record[EXTRA_PROPERTIES_KEY][propName];\r\n    const key = lookupEnum.transformed[value];\r\n    const l10n = data.getInjected(LocalizationService);\r\n    const localizeEnum = createEnumLocalizer(l10n, enumType, lookupEnum);\r\n\r\n    return createLocalizationStream(l10n, localizeEnum(key));\r\n  };\r\n}\r\n\r\nexport function createEnumOptions<T = any>(\r\n  enumType: string,\r\n  lookupEnum: ObjectExtensions.Enum,\r\n): PropCallback<T, Observable<ABP.Option<any>[]>> {\r\n  return data => {\r\n    const l10n = data.getInjected(LocalizationService);\r\n    const localizeEnum = createEnumLocalizer(l10n, enumType, lookupEnum);\r\n\r\n    return createLocalizationStream(\r\n      l10n,\r\n      lookupEnum.fields.map(({ name, value }) => ({\r\n        key: localizeEnum(name),\r\n        value,\r\n      })),\r\n    );\r\n  };\r\n}\r\n\r\nfunction createLocalizationStream(l10n: LocalizationService, mapTarget: any) {\r\n  return merge(of(null), l10n.languageChange).pipe(map(() => mapTarget));\r\n}\r\n\r\nfunction createEnumLocalizer(\r\n  l10n: LocalizationService,\r\n  enumType: string,\r\n  lookupEnum: ObjectExtensions.Enum,\r\n): (key: string) => string {\r\n  const resource = lookupEnum.localizationResource;\r\n  const shortType = getShortEnumType(enumType);\r\n\r\n  return key =>\r\n    l10n.localizeWithFallbackSync(\r\n      [resource],\r\n      ['Enum:' + shortType + '.' + key, shortType + '.' + key, key],\r\n      key,\r\n    );\r\n}\r\n\r\nfunction getShortEnumType(enumType: string): string {\r\n  return enumType.split('.').pop();\r\n}\r\n","import { ABP, ApplicationConfiguration } from '@abp/ng.core';\r\nimport { createSelector, Store } from '@ngxs/store';\r\nimport { Observable, pipe, zip } from 'rxjs';\r\nimport { filter, map, switchMap, take } from 'rxjs/operators';\r\nimport { ePropType } from '../enums/props.enum';\r\nimport { EntityProp, EntityPropList } from '../models/entity-props';\r\nimport { FormProp, FormPropList } from '../models/form-props';\r\nimport { ObjectExtensions } from '../models/object-extensions';\r\nimport { PropCallback } from '../models/props';\r\nimport { createEnum, createEnumOptions, createEnumValueResolver } from './enum.util';\r\nimport { createDisplayNameLocalizationPipeKeyGenerator } from './localization.util';\r\nimport { createExtraPropertyValueResolver } from './props.util';\r\nimport { getValidatorsFromProperty } from './validation.util';\r\n\r\nconst selectConfig = (state: any) => state.ConfigState;\r\n\r\nconst selectObjectExtensions = createSelector(\r\n  [selectConfig],\r\n  (config: ObjectExtensions.Config) => config.objectExtensions,\r\n);\r\n\r\nconst selectLocalization = createSelector(\r\n  [selectConfig],\r\n  (config: ApplicationConfiguration.Response) => config.localization,\r\n);\r\n\r\nconst selectEnums = createSelector(\r\n  [selectObjectExtensions, selectLocalization],\r\n  (extensions: ObjectExtensions.Item) =>\r\n    Object.keys(extensions.enums).reduce((acc, key) => {\r\n      const { fields, localizationResource } = extensions.enums[key];\r\n      acc[key] = {\r\n        fields,\r\n        localizationResource,\r\n        transformed: createEnum(fields),\r\n      };\r\n      return acc;\r\n    }, {} as ObjectExtensions.Enums),\r\n);\r\n\r\nconst createObjectExtensionEntitiesSelector = (moduleKey: ModuleKey) =>\r\n  createSelector([selectObjectExtensions], (extensions: ObjectExtensions.Item) => {\r\n    if (!extensions) return null;\r\n\r\n    return (extensions.modules[moduleKey] || ({} as ObjectExtensions.Module)).entities;\r\n  });\r\n\r\nexport function getObjectExtensionEntitiesFromStore(store: Store, moduleKey: ModuleKey) {\r\n  return store.select(createObjectExtensionEntitiesSelector(moduleKey)).pipe(\r\n    map(entities => (isUndefined(entities) ? {} : entities)),\r\n    filter<ObjectExtensions.Entities>(Boolean),\r\n    take(1),\r\n  );\r\n}\r\n\r\nexport function mapEntitiesToContributors<T = any>(store: Store, resource: string) {\r\n  return pipe(\r\n    switchMap(entities =>\r\n      zip(store.select(selectLocalization), store.select(selectEnums)).pipe(\r\n        map(([localization, enums]) => {\r\n          const generateDisplayName = createDisplayNameLocalizationPipeKeyGenerator(localization);\r\n\r\n          return Object.keys(entities).reduce(\r\n            (acc, key: keyof ObjectExtensions.Entities) => {\r\n              acc.prop[key] = [];\r\n              acc.createForm[key] = [];\r\n              acc.editForm[key] = [];\r\n\r\n              const entity: ObjectExtensions.Entity = entities[key];\r\n              if (!entity) return acc;\r\n\r\n              const properties = entity.properties;\r\n              if (!properties) return acc;\r\n\r\n              const mapPropertiesToContributors = createPropertiesToContributorsMapper<T>(\r\n                generateDisplayName,\r\n                resource,\r\n                enums,\r\n              );\r\n\r\n              return mapPropertiesToContributors(properties, acc, key);\r\n            },\r\n            {\r\n              prop: {},\r\n              createForm: {},\r\n              editForm: {},\r\n            } as ObjectExtensions.PropContributors,\r\n          );\r\n        }),\r\n      ),\r\n    ),\r\n    take(1),\r\n  );\r\n}\r\n\r\nfunction createPropertiesToContributorsMapper<T = any>(\r\n  generateDisplayName: DisplayNameGeneratorFn,\r\n  resource: string,\r\n  enums: Record<string, ObjectExtensions.Enum>,\r\n) {\r\n  return (\r\n    properties: Record<string, ObjectExtensions.Property>,\r\n    contributors: ObjectExtensions.PropContributors<T>,\r\n    key: string,\r\n  ) => {\r\n    const isExtra = true;\r\n\r\n    Object.keys(properties).forEach((name: string) => {\r\n      const property = properties[name];\r\n      const type = getTypeFromProperty(property);\r\n      const displayName = generateDisplayName(property.displayName, { name, resource });\r\n\r\n      if (property.ui.onTable.isVisible) {\r\n        const sortable = Boolean(property.ui.onTable.isSortable);\r\n        const columnWidth = type === ePropType.Boolean ? 150 : 250;\r\n        const valueResolver =\r\n          type === ePropType.Enum\r\n            ? createEnumValueResolver(property.type, enums[property.type], name)\r\n            : createExtraPropertyValueResolver<T>(name);\r\n\r\n        const entityProp = new EntityProp<T>({\r\n          type,\r\n          name,\r\n          displayName,\r\n          sortable,\r\n          columnWidth,\r\n          valueResolver,\r\n          isExtra,\r\n        });\r\n\r\n        const contributor = (propList: EntityPropList<T>) => propList.addTail(entityProp);\r\n        contributors.prop[key].push(contributor);\r\n      }\r\n\r\n      const isOnCreateForm = property.ui.onCreateForm.isVisible;\r\n      const isOnEditForm = property.ui.onEditForm.isVisible;\r\n\r\n      if (isOnCreateForm || isOnEditForm) {\r\n        const defaultValue = property.defaultValue;\r\n        const validators = () => getValidatorsFromProperty(property);\r\n        let options: PropCallback<any, Observable<ABP.Option<any>[]>>;\r\n        if (type === ePropType.Enum) options = createEnumOptions(name, enums[property.type]);\r\n\r\n        const formProp = new FormProp({\r\n          type,\r\n          name,\r\n          displayName,\r\n          options,\r\n          defaultValue,\r\n          validators,\r\n          isExtra,\r\n        });\r\n\r\n        const formContributor = (propList: FormPropList<T>) => propList.addTail(formProp);\r\n\r\n        if (isOnCreateForm) contributors.createForm[key].push(formContributor);\r\n        if (isOnEditForm) contributors.editForm[key].push(formContributor);\r\n      }\r\n    });\r\n\r\n    return contributors;\r\n  };\r\n}\r\n\r\nfunction getTypeFromProperty(property: ObjectExtensions.Property): ePropType {\r\n  return (property.typeSimple.replace(/\\?$/, '') as string) as ePropType;\r\n}\r\n\r\nfunction isUndefined(obj: any): obj is undefined {\r\n  return typeof obj === 'undefined';\r\n}\r\n\r\ntype DisplayNameGeneratorFn = ReturnType<typeof createDisplayNameLocalizationPipeKeyGenerator>;\r\ntype ModuleKey = keyof ObjectExtensions.Modules;\r\n","import { FormControl, FormGroup } from '@angular/forms';\r\nimport { DateTimeAdapter } from '../adapters/date-time.adapter';\r\nimport { DateAdapter } from '../adapters/date.adapter';\r\nimport { TimeAdapter } from '../adapters/time.adapter';\r\nimport { EXTRA_PROPERTIES_KEY } from '../constants/extra-properties';\r\nimport { ePropType } from '../enums/props.enum';\r\nimport { FormPropList } from '../models/form-props';\r\nimport { PropData } from '../models/props';\r\nimport { ExtensionsService } from '../services/extensions.service';\r\nimport { EXTENSIONS_IDENTIFIER } from '../tokens/extensions.token';\r\n\r\nexport function generateFormFromProps<R extends any>(data: PropData<R>) {\r\n  const extensions = data.getInjected(ExtensionsService);\r\n  const identifier = data.getInjected(EXTENSIONS_IDENTIFIER);\r\n\r\n  const form = new FormGroup({});\r\n  const extraForm = new FormGroup({});\r\n  form.addControl(EXTRA_PROPERTIES_KEY, extraForm);\r\n\r\n  const record = data.record || {};\r\n  const type = JSON.stringify(record) === '{}' ? 'create' : 'edit';\r\n  const props: FormPropList<R> = extensions[`${type}FormProps`].get(identifier).props;\r\n  const extraProperties = record[EXTRA_PROPERTIES_KEY] || {};\r\n\r\n  props.forEach(({ value: prop }) => {\r\n    const name = prop.name;\r\n    const isExtraProperty = prop.isExtra || name in extraProperties;\r\n    let value = isExtraProperty ? extraProperties[name] : name in record ? record[name] : undefined;\r\n\r\n    if (typeof value === 'undefined') value = prop.defaultValue;\r\n\r\n    if (value) {\r\n      let adapter: DateAdapter | TimeAdapter | DateTimeAdapter;\r\n      switch (prop.type) {\r\n        case ePropType.Date:\r\n          adapter = new DateAdapter();\r\n          value = adapter.toModel(adapter.fromModel(value));\r\n          break;\r\n        case ePropType.Time:\r\n          adapter = new TimeAdapter();\r\n          value = adapter.toModel(adapter.fromModel(value));\r\n          break;\r\n        case ePropType.DateTime:\r\n          adapter = new DateTimeAdapter();\r\n          value = adapter.toModel(adapter.fromModel(value) as any);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    const formControl = new FormControl(value, {\r\n      asyncValidators: prop.asyncValidators(data),\r\n      validators: prop.validators(data),\r\n    });\r\n\r\n    (isExtraProperty ? extraForm : form).addControl(name, formControl);\r\n  });\r\n\r\n  return form;\r\n}\r\n","import { ApplicationConfiguration, createLocalizationPipeKeyGenerator } from '@abp/ng.core';\r\nimport { ObjectExtensions } from '../models/object-extensions';\r\n\r\nexport function createDisplayNameLocalizationPipeKeyGenerator(\r\n  localization: ApplicationConfiguration.Localization,\r\n) {\r\n  const generateLocalizationPipeKey = createLocalizationPipeKeyGenerator(localization);\r\n\r\n  return (displayName: ObjectExtensions.DisplayName, fallback: ObjectExtensions.DisplayName) => {\r\n    if (displayName && displayName.name)\r\n      return generateLocalizationPipeKey(\r\n        [displayName.resource],\r\n        [displayName.name],\r\n        displayName.name,\r\n      );\r\n\r\n    const key = generateLocalizationPipeKey(\r\n      [fallback.resource],\r\n      ['DisplayName:' + fallback.name],\r\n      undefined,\r\n    );\r\n\r\n    if (key) return key;\r\n\r\n    return generateLocalizationPipeKey([fallback.resource], [fallback.name], fallback.name);\r\n  };\r\n}\r\n","import { AbpValidators } from '@abp/ng.core';\r\nimport { ValidatorFn } from '@angular/forms';\r\nimport { ObjectExtensions } from '../models/object-extensions';\r\n\r\nexport function getValidatorsFromProperty(property: ObjectExtensions.Property): ValidatorFn[] {\r\n  const validators: ValidatorFn[] = [];\r\n\r\n  property.attributes.forEach(attr => {\r\n    if (attr.typeSimple in AbpValidators)\r\n      validators.push(AbpValidators[attr.typeSimple](attr.config));\r\n  });\r\n\r\n  return validators;\r\n}\r\n","import { ActionContributorCallback, ActionList, ActionsFactory } from '../models/actions';\r\nimport {\r\n  EntityActionContributorCallbacks,\r\n  EntityActionDefaults,\r\n  EntityActions,\r\n  EntityActionsFactory,\r\n} from '../models/entity-actions';\r\nimport {\r\n  ToolbarActionContributorCallbacks,\r\n  ToolbarActionDefaults,\r\n  ToolbarActions,\r\n  ToolbarActionsFactory,\r\n} from '../models/toolbar-actions';\r\n\r\nexport function mergeWithDefaultActions<F extends ActionsFactory<any>>(\r\n  extension: F,\r\n  defaultActions: InferredActionDefaults<F>,\r\n  ...contributors: InferredActionContributorCallbacks<F>[]\r\n) {\r\n  Object.keys(defaultActions).forEach((name: string) => {\r\n    const actions: InferredActions<F> = extension.get(name);\r\n    actions.clearContributors();\r\n    actions.addContributor((actionList: ActionList) =>\r\n      actionList.addManyTail(defaultActions[name]),\r\n    );\r\n    contributors.forEach(contributor =>\r\n      (contributor[name] || []).forEach((callback: ActionContributorCallback<any>) =>\r\n        actions.addContributor(callback),\r\n      ),\r\n    );\r\n  });\r\n}\r\ntype InferredActionDefaults<F> = F extends EntityActionsFactory<infer RE>\r\n  ? EntityActionDefaults<RE>\r\n  : F extends ToolbarActionsFactory<infer RT>\r\n  ? ToolbarActionDefaults<RT>\r\n  : never;\r\n\r\ntype InferredActionContributorCallbacks<F> = F extends EntityActionsFactory<infer RE>\r\n  ? EntityActionContributorCallbacks<RE>\r\n  : F extends ToolbarActionsFactory<infer RT>\r\n  ? ToolbarActionContributorCallbacks<RT>\r\n  : never;\r\n\r\ntype InferredActions<F> = F extends EntityActionsFactory<infer RE>\r\n  ? EntityActions<RE>\r\n  : F extends ToolbarActionsFactory<infer RT>\r\n  ? ToolbarActions<RT>\r\n  : never;\r\n"]}