!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@fs/ng-alain/basic"),require("@abp/ng.core"),require("@angular/router"),require("ang-jsoneditor"),require("lodash"),require("@ngxs/store"),require("@fs/theme.core"),require("rxjs/operators"),require("rxjs"),require("@angular/forms"),require("@fs/ng-alain/core"),require("ng-zorro-antd"),require("@abp/ng.setting-management")):"function"==typeof define&&define.amd?define("@fs/setting-management/ng-alain",["exports","@angular/core","@fs/ng-alain/basic","@abp/ng.core","@angular/router","ang-jsoneditor","lodash","@ngxs/store","@fs/theme.core","rxjs/operators","rxjs","@angular/forms","@fs/ng-alain/core","ng-zorro-antd","@abp/ng.setting-management"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).fs=e.fs||{},e.fs["setting-management"]=e.fs["setting-management"]||{},e.fs["setting-management"]["ng-alain"]={}),e.ng.core,e.basic,e.ng_core,e.ng.router,e.angJsoneditor,e._,e.store,e.theme_core,e.rxjs.operators,e.rxjs,e.ng.forms,e.core$1,e.ngZorroAntd,e.ng_settingManagement)}(this,(function(e,t,n,i,o,r,a,s,l,p,d,u,g,c,h){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function f(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function y(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}e.ModalComponent=function(){function e(e){this.themeCoreStateService=e,this.providerName=void 0,this.providerKey=void 0,this.rawData=null,this._visible=!1,this.visibleChange=new t.EventEmitter,this._isEdited=!1,this.isEditedChange=new t.EventEmitter,this.settingGroups=null,this.settingValue=null,this.loading=!1,this.destroy$=new d.Subject}return Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=!!e,e?this.visibleChange.emit(e):(this.rawData=null,this.settingValue=null,this.loading=!1,this.visibleChange.emit(!1)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=!!e,e?this.isEditedChange.emit(e):this.isEditedChange.emit(!1))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.settingdata$.pipe(p.takeUntil(this.destroy$)).subscribe((function(t){t&&e.loadSettingGroups(t)}))},e.prototype.ngOnDestroy=function(){this.destroy$.next()},e.prototype.ngOnChanges=function(){this.visible&&this.rawData&&(this.loadSettingGroups(this.themeCoreStateService.getSettingsGroups()),this.loadData())},e.prototype.loadSettingGroups=function(e){this.settingGroups=null;var t=a.uniq(e);this.settingGroups=t.filter((function(e,t,n){return 0==n.filter((function(n,i){return t!=i&&a.startsWith(e,n+".")})).length}))},e.prototype.loadData=function(){var e=this;this.loading=!0,this.settingValue=[];var t=this.rawData.settingValues;this.rawData.availableSettingsDefinitions.forEach((function(n){var i=a.findIndex(t,(function(e){return e.name===n.name}));-1!=i?e.settingValue.push({name:n.name,value:t[i].value,displayName:n.displayName,properties:n.properties}):e.settingValue.push({name:n.name,value:n.defaultValue,displayName:n.displayName,properties:n.properties})})),this.loading=!1},e.prototype.close=function(){this.visible=!1},e}(),f([s.Select(l.ThemeCoreState.getSettingsGroups),y("design:type",d.Observable)],e.ModalComponent.prototype,"settingdata$",void 0),f([t.Input(),y("design:type",String)],e.ModalComponent.prototype,"providerName",void 0),f([t.Input(),y("design:type",String)],e.ModalComponent.prototype,"providerKey",void 0),f([t.Input(),y("design:type",l.CodesWithSettingsOutput)],e.ModalComponent.prototype,"rawData",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.ModalComponent.prototype,"visible",null),f([t.Output(),y("design:type",Object)],e.ModalComponent.prototype,"visibleChange",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.ModalComponent.prototype,"isEdited",null),f([t.Output(),y("design:type",Object)],e.ModalComponent.prototype,"isEditedChange",void 0),e.ModalComponent=f([t.Component({selector:"fs-ng-alain-setting-management",template:'<nz-modal\r\n    [(nzVisible)]="visible"\r\n    [nzTitle]="tplTitle"\r\n    [nzContent]="tplContent"\r\n    [nzFooter]="tplFooter"\r\n    (nzOnCancel)="close()"\r\n    [nzWidth]="760"\r\n>\r\n    <ng-template #tplTitle>\r\n        <span>SettingManagement</span>\r\n    </ng-template>\r\n    \r\n    <ng-template #tplContent>\r\n        <fs-ng-alain-setting-management-main\r\n            [providerName]="providerName"\r\n            [providerKey]="providerKey"\r\n            [settingGroups]="settingGroups"\r\n            [(visible)]="visible"\r\n            [(isEdited)]="isEdited"\r\n            [rawData]="settingValue">\r\n        </fs-ng-alain-setting-management-main>\r\n    </ng-template>\r\n    \r\n    <ng-template #tplFooter>\r\n        <button nz-button (click)="close()" [nzLoading]="loading">離開</button>\r\n    </ng-template>\r\n</nz-modal>',styles:[".textColor{color:red}"]}),y("design:paramtypes",[l.ThemeCoreStateService])],e.ModalComponent),e.MainComponent=function(){function e(e){this.store=e,this.providerName=void 0,this.providerKey=void 0,this.rawData=null,this.settingGroups=null,this._visible=!1,this.visibleChange=new t.EventEmitter,this._isEdited=!1,this.isEditedChange=new t.EventEmitter,this.editedData={},this.settingValue=null,this.loading=!1}return Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=!!e,e?this.visibleChange.emit(e):(this.rawData=null,this.editedData={},this.settingValue=null,this.loading=!1,this.visibleChange.emit(!1)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=!!e,e?this.isEditedChange.emit(e):this.isEditedChange.emit(!1))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){this.visible&&this.rawData&&this.loadData()},e.prototype.loadData=function(){var e=this;this.loading=!0,this.editedData={},this.settingValue={},this.settingGroups.forEach((function(t,n){var i=e.rawData.filter((function(e){return a.startsWith(e.name,t)}));i.length>0?e.settingValue[t]={group:t,settingData:i}:e.settingGroups[n]=null})),this.settingGroups=this.settingGroups.filter((function(e){return null!=e})),this.loading=!1},e.prototype.setTextColor=function(e){if(this.editedData==={})return!1;for(var t in this.editedData)if(a.startsWith(t,e))return!0;return!1},e.prototype.ngOnDestroy=function(){},e}(),f([t.Input(),y("design:type",String)],e.MainComponent.prototype,"providerName",void 0),f([t.Input(),y("design:type",String)],e.MainComponent.prototype,"providerKey",void 0),f([t.Input(),y("design:type",Array)],e.MainComponent.prototype,"rawData",void 0),f([t.Input(),y("design:type",Array)],e.MainComponent.prototype,"settingGroups",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.MainComponent.prototype,"visible",null),f([t.Output(),y("design:type",Object)],e.MainComponent.prototype,"visibleChange",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.MainComponent.prototype,"isEdited",null),f([t.Output(),y("design:type",Object)],e.MainComponent.prototype,"isEditedChange",void 0),e.MainComponent=f([t.Component({selector:"fs-ng-alain-setting-management-main",template:'<nz-spin [nzSpinning]="loading">\r\n    <nz-tabset>\r\n        <nz-tab\r\n            *ngFor="let item of settingGroups" nzPlacement="right"\r\n            [nzTitle]="titleTemplate">\r\n            <ng-template #titleTemplate><span [class.textColor]="setTextColor(item)">{{ \'Themes::\'+item | abpLocalization }}</span></ng-template>\r\n            <nz-page-header-content *ngIf="visible && settingValue">\r\n                    <fs-ng-alain-setting-management-detail\r\n                        [providerName]="providerName"\r\n                        [providerKey]="providerKey"\r\n                        [rawData]="settingValue[item]"\r\n                        [(visible)]="visible"\r\n                        [(isEdited)]="isEdited"\r\n                        [(editedData)]="editedData">\r\n                    </fs-ng-alain-setting-management-detail>\r\n            </nz-page-header-content>\r\n        </nz-tab>\r\n    </nz-tabset>\r\n</nz-spin>',styles:[".textColor{color:red}"]}),y("design:paramtypes",[s.Store])],e.MainComponent),e.DetailComponent=function(){function e(e,n,i,o,r){this.store=e,this.fb=n,this.changeDetectorRef=i,this.notifyService=o,this.nzContextMenuService=r,this.providerName=void 0,this.providerKey=void 0,this.rawData=null,this._visible=!1,this.visibleChange=new t.EventEmitter,this._isEdited=!1,this.isEditedChange=new t.EventEmitter,this._editedData={},this.editedDataChange=new t.EventEmitter,this.treeData=[],this.loading=!1,this.isExpanded=!0,this.seletedNode=""}return Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=!!e,e?this.visibleChange.emit(e):(this.rawData=null,this.treeData=[],this.editedData={},this.loading=!1,this.isExpanded=!0,this.seletedNode="",this.visibleChange.emit(!1)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=!!e,e?this.isEditedChange.emit(e):this.isEditedChange.emit(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editedData",{get:function(){return this._editedData},set:function(e){e!==this._editedData&&(e!={}?(this._editedData=e,this.editedDataChange.emit(e)):(this._editedData={},this.editedDataChange.emit({})))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){this.visible&&this.rawData&&(this.form=new u.FormGroup({}),this.loading=!0,this.treeData=this.loadData(this.rawData),this.buildForm(),this.init(),this.treeStatusChange("isExpanded",this.isExpanded))},e.prototype.init=function(){this.changeDetectorRef.detectChanges(),this.fsNgAlainTreeComponent.init()},e.prototype.loadData=function(e){var t=this,n=[],i=e.group.split(".").length;return e.settingData.forEach((function(e){n=n.concat(t.splitName(i,e))})),a.uniqBy(n,"id")},e.prototype.splitName=function(e,t){var n=[],i=a.drop(a.dropRight(t.name.split(".")),e);return i.forEach((function(e,t){n.push({id:0===t?e:n[t-1].id+"."+e,parentId:0===t?null:n[t-1].id,displayName:0===t?e:n[t-1].displayName+"."+e})})),t.id=t.name,t.parentId=i.length>0?a.last(n).id:null,n.push(t),n},e.prototype.buildForm=function(){var e=this,t={};this.rawData.settingData.forEach((function(n,i){if(null===n.value)n.value="",e.rawData.settingData[i].value="";else try{switch(n.value=JSON.parse(a.toLower(n.value)),typeof n.value){case"boolean":e.rawData.settingData[i].properties.Type="Boolean";break;case"number":e.rawData.settingData[i].properties.Type="Decimal"}}catch(t){n.properties.Type?"Boolean"===n.properties.Type&&(n.value=!1):e.rawData.settingData[i].properties.Type="String"}t[n.name]=[n.value,[]]})),this.form=this.fb.group(t),this.form.valueChanges.subscribe((function(t){var n=e.seletedNode,i=a.head(e.rawData.settingData.filter((function(e){return e.name===n})));i.value="string"!=typeof i.value?JSON.stringify(i.value):i.value;var o="string"!=typeof t[n]?JSON.stringify(t[n]):t[n];i.value!==o?e.editedData[n]=o:delete e.editedData[n],e.changeDetectorRef.detectChanges()})),this.loading=!1},e.prototype.save=function(){var e=this;this.loading=!0;var t={providerName:this.providerName,providerKey:this.providerKey,forceToSet:!1,data:this.editedData};this.store.dispatch(new l.UpdateSettingsByProviderName(t)).pipe(p.finalize((function(){return e.loading=!1}))).subscribe((function(t){e.providerKey&&(e.isEdited=!0,e.visible=!1),e.notifyService.success("資料更新成功")}),(function(t){e.notifyService.error("資料更新失敗")}))},e.prototype.clickItem=function(e){this.nzContextMenuService.close(),e.isLeaf&&(this.seletedNode===e.key?this.seletedNode="":this.seletedNode=e.key)},e.prototype.searchColor=function(e){if(!this.fsNgAlainTreeComponent||!this.fsNgAlainTreeComponent.searchValue)return e.title;var t="";this.fsNgAlainTreeComponent.searchValue.split("").forEach((function(e){"~!@#$%^&*()_+=-|\\?/.,<>'\";:[]{}".includes(e)?t+="\\"+e:t+=e}));var n=new RegExp(t),i="<span class='font-highlight'>"+this.fsNgAlainTreeComponent.searchValue+"</span>";return e.title.replace(n,i)},e.prototype.treeStatusChange=function(e,t){void 0===t&&(t=!1),this.isExpanded=t,this.fsNgAlainTreeComponent.treeStatusChange(e,t)},e.prototype.reLoadData=function(){this.editedData={},this.buildForm(),this.init(),this.treeStatusChange("isExpanded",this.isExpanded)},e}(),f([t.ViewChild(n.FsNgAlainTreeComponent,{static:!1}),y("design:type",n.FsNgAlainTreeComponent)],e.DetailComponent.prototype,"fsNgAlainTreeComponent",void 0),f([t.Input(),y("design:type",String)],e.DetailComponent.prototype,"providerName",void 0),f([t.Input(),y("design:type",String)],e.DetailComponent.prototype,"providerKey",void 0),f([t.Input(),y("design:type",Object)],e.DetailComponent.prototype,"rawData",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.DetailComponent.prototype,"visible",null),f([t.Output(),y("design:type",Object)],e.DetailComponent.prototype,"visibleChange",void 0),f([t.Input(),y("design:type",Boolean),y("design:paramtypes",[Boolean])],e.DetailComponent.prototype,"isEdited",null),f([t.Output(),y("design:type",Object)],e.DetailComponent.prototype,"isEditedChange",void 0),f([t.Input(),y("design:type",Object),y("design:paramtypes",[Object])],e.DetailComponent.prototype,"editedData",null),f([t.Output(),y("design:type",Object)],e.DetailComponent.prototype,"editedDataChange",void 0),e.DetailComponent=f([t.Component({selector:"fs-ng-alain-setting-management-detail",template:'<nz-row>\r\n  <nz-col>\r\n    <button nzType="primary" nz-button\r\n      (click)="treeStatusChange(\'isExpanded\', !isExpanded)">{{ (isExpanded) ? \'全部收合\' : \'全部展開\' }}</button>\r\n    <button nzType="primary" nz-button (click)="save()" *ngIf="providerName !== \'D\' && providerName !== \'C\'">儲存變更</button>\r\n    <button nzType="danger" nz-button (click)="reLoadData()">取消變更</button>\r\n  </nz-col>\r\n</nz-row>\r\n<div class="my-md"></div>\r\n<nz-spin [nzSpinning]="loading">\r\n  <div style="background-color:#FFF">\r\n    <fs-ng-alain-tree\r\n      [tree]="treeData"\r\n      [treeItem]="treeData"\r\n      [showCountType]="1"\r\n      [nzDefaultExpandAll]="isExpanded"\r\n      [nzCheckable]="false"\r\n      [showCheckAll]="false"\r\n      [leafNodes]="true"\r\n      [nzDraggable]="false"\r\n      [nzShowLine]="true"\r\n      [nzDefaultSearch]="true"\r\n      [nzTreeTemplate]="nzTreeTemplate">\r\n    </fs-ng-alain-tree>\r\n  </div>\r\n</nz-spin>\r\n<nz-back-top></nz-back-top>\r\n\r\n<ng-template #nzTreeTemplate let-node>\r\n  <span\r\n    class="custom-node"\r\n    [class.node-active]="seletedNode == node.key"\r\n    [class.textColor]="editedData[node.key] != undefined"\r\n    (click)="clickItem(node)"\r\n    [innerHtml]="searchColor(node)">\r\n  </span>\r\n  <br />\r\n  <div *ngIf="seletedNode == node.key && node.isLeaf">\r\n    <div [formGroup]="form" style="margin: 1em 0px">\r\n      <nz-form-control nzExtra="SettingName：{{ node.origin.name }}">\r\n        <ng-container [ngSwitch]="node.origin.properties.Type">\r\n          <ng-container *ngSwitchDefault>\r\n            <fs-ng-alain-json-editor [form]="form" [data]="node.origin.id"></fs-ng-alain-json-editor>\r\n          </ng-container>\r\n          <nz-input-number *ngSwitchCase="\'Int16\'" style="width: 100%;" [formControlName]="node.origin.id" [nzStep]="1">\r\n          </nz-input-number>\r\n          <nz-input-number *ngSwitchCase="\'Int32\'" style="width: 100%;" [formControlName]="node.origin.id" [nzStep]="1">\r\n          </nz-input-number>\r\n          <nz-input-number *ngSwitchCase="\'Int64\'" style="width: 100%;" [formControlName]="node.origin.id" [nzStep]="1">\r\n          </nz-input-number>\r\n          <nz-input-number *ngSwitchCase="\'Float\'" style="width: 100%;" [formControlName]="node.origin.id">\r\n          </nz-input-number>\r\n          <nz-input-number *ngSwitchCase="\'Decimal\'" style="width: 100%;" [formControlName]="node.origin.id">\r\n          </nz-input-number>\r\n          <label nz-checkbox *ngSwitchCase="\'Boolean\'" [formControlName]="node.origin.id"></label>\r\n          <input *ngSwitchCase="\'String\'" nz-input style="width: 100%;" nzSize="default"\r\n            [formControlName]="node.origin.id" />\r\n        </ng-container>\r\n      </nz-form-control>\r\n    </div>\r\n  </div>\r\n</ng-template>',styles:[".custom-node{background:#fff;cursor:pointer;display:inline-block;height:24px;transition:all .3s;width:100%}.custom-node:hover{background:#e6f7ff}.node-active{background:#bae7ff;transition:all .3s}.node-active:hover{background:#bae7ff!important}.textColor{color:red}"]}),y("design:paramtypes",[s.Store,u.FormBuilder,t.ChangeDetectorRef,g.NotifyService,c.NzContextMenuService])],e.DetailComponent),e.ɵa=function(){function e(){this.editorOptions=new r.JsonEditorOptions,this.editorOptions.modes=["code","text","tree","view"]}return e.prototype.ngOnInit=function(){},e}(),f([t.Input(),y("design:type",u.FormGroup)],e.ɵa.prototype,"form",void 0),f([t.Input(),y("design:type",String)],e.ɵa.prototype,"data",void 0),f([t.ViewChild(r.JsonEditorComponent,{static:!0}),y("design:type",r.JsonEditorComponent)],e.ɵa.prototype,"editor",void 0),e.ɵa=f([t.Component({selector:"fs-ng-alain-json-editor",template:'<div [formGroup]="form">\r\n    <json-editor #editor [options]="editorOptions" [formControlName]="data"></json-editor>\r\n</div>'}),y("design:paramtypes",[])],e.ɵa),e.SettingManagementComponent=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._store=t,i._settingTabs=n,i}return function(e,t){function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(h.SettingManagementComponent),e.SettingManagementComponent=f([t.Component({selector:"fs-setting-management",template:'<fs-page-bar></fs-page-bar>\r\n\r\n<nz-row nzGutter="16">\r\n    <nz-col [nzLg]="24" [nzXl]="5" style="padding-bottom: 10px;">\r\n        <ul nz-menu nzMode="inline">\r\n            <ul>\r\n                <li nz-menu-item nz-popover *ngFor="let setting of settings" (click)="selected = setting" [abpPermission]="setting.requiredPolicy">\r\n                    {{ setting.name | abpLocalization }}\r\n                </li>\r\n            </ul>\r\n        </ul>\r\n    </nz-col>\r\n    <nz-col [nzLg]="24" [nzXl]="19" *ngIf="settings.length">\r\n        <ng-container *ngComponentOutlet="selected.component"></ng-container>\r\n    </nz-col>\r\n</nz-row>\r\n  ',styles:[""]}),y("design:paramtypes",[s.Store,i.SettingTabsService])],e.SettingManagementComponent),e.MySettingsComponent=function(){function e(e){this.configStateService=e,this.settings={},this.keys=[]}return e.prototype.ngOnInit=function(){this.settings=this.configStateService.getSettings(),this.keys=Object.keys(this.settings)},e}(),e.MySettingsComponent=f([t.Component({selector:"app-my-settings",template:'<nz-table #basicTable [nzData]="keys">\r\n    <thead>\r\n      <tr>\r\n        <th>Key</th>\r\n        <th>Value</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor="let data of basicTable.data">\r\n        <td>{{ data }}</td>\r\n        <td>{{ settings[data] }}</td>\r\n      </tr>\r\n    </tbody>\r\n</nz-table>\r\n  \r\n',styles:[""]}),y("design:paramtypes",[i.ConfigStateService])],e.MySettingsComponent),e.MySettings2Component=function(){function e(e){this.configStateService=e,this.settings={},this.keys=[]}return e.prototype.ngOnInit=function(){this.settings=this.configStateService.getSettings(),this.keys=Object.keys(this.settings)},e}(),e.MySettings2Component=f([t.Component({selector:"app-my-settings2",template:'<nz-table #basicTable [nzData]="keys">\r\n    <thead>\r\n      <tr>\r\n        <th>Key</th>\r\n        <th>Value</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr *ngFor="let data of basicTable.data">\r\n        <td>{{ data }}</td>\r\n        <td>{{ settings[data] }}</td>\r\n      </tr>\r\n    </tbody>\r\n</nz-table>\r\n',styles:[""]}),y("design:paramtypes",[i.ConfigStateService])],e.MySettings2Component);var C=[e.ModalComponent,e.MainComponent,e.DetailComponent,e.ɵa,e.SettingManagementComponent,e.MySettingsComponent,e.MySettings2Component];e.SharedModule=function(){},e.SharedModule=f([t.NgModule({declarations:b(C),imports:[n.NgAlainBasicModule,r.NgJsonEditorModule],exports:b([n.NgAlainBasicModule],C)})],e.SharedModule),e.ɵe=function(){function e(e,t,n){this.store=e,this.notifyService=t,this.themeCoreStateService=n,this.providerNameList=[{tag:"D",displayName:"DefaultValue"},{tag:"C",displayName:"Configuration"},{tag:"G",displayName:"Global"},{tag:"T",displayName:"Tenant"},{tag:"U",displayName:"User"}],this.settingGroups=null,this.selectedSettingData=null,this.loading=!1,this.visible=!1,this.providerName=null,this.providerKey=null,this.destroy$=new d.Subject}return e.prototype.ngOnInit=function(){var e=this;this.settingdata$.pipe(p.takeUntil(this.destroy$)).subscribe((function(t){t&&e.visible&&e.selectedSettingData&&(e.selectedSettingData=t.map((function(e){return{name:e.name,value:e.value,displayName:e.displayName,properties:e.properties}})))})),this.settingGroupdata$.pipe(p.takeUntil(this.destroy$)).subscribe((function(t){if(e.settingGroups=null,t){var n=a.uniq(t);e.settingGroups=n.filter((function(e,t,n){return 0==n.filter((function(n,i){return t!=i&&a.startsWith(e,n+".")})).length}))}}))},e.prototype.ngOnDestroy=function(){this.destroy$.next()},e.prototype.editManageAction=function(e){var t=this;this.loading=!0;var n={providerName:e,providerKey:void 0};this.store.dispatch(new l.GetSettingByNameAndKey(n)).pipe(p.finalize((function(){return t.loading=!1}))).subscribe((function(){t.setting(!0,n)}),(function(e){t.notifyService.error("查詢失敗")}))},e.prototype.setting=function(e,t){this.visible=e,this.providerName=t.providerName,this.providerKey=t.providerKey;var n=this.themeCoreStateService.getSettingsByProviderName();this.selectedSettingData=n.map((function(e){return{name:e.name,value:e.value,displayName:e.displayName,properties:e.properties}}))},e}(),f([s.Select(l.ThemeCoreState.getSettingsByProviderName),y("design:type",d.Observable)],e.ɵe.prototype,"settingdata$",void 0),f([s.Select(l.ThemeCoreState.getSettingsGroups),y("design:type",d.Observable)],e.ɵe.prototype,"settingGroupdata$",void 0),e.ɵe=f([t.Component({selector:"fs-main",template:'<nz-row nzGutter="16">\r\n    <nz-col [nzLg]="24" [nzXl]="5" style="padding-bottom: 10px;">\r\n        <ul nz-menu nzMode="inline">\r\n            <ul>\r\n                <li nz-menu-item nz-popover *ngFor="let item of providerNameList" (click)="editManageAction(item.tag)">\r\n                    <nz-tag [nzColor]="\'green\'">{{ item.tag }}</nz-tag>\r\n                    {{ item.displayName }}\r\n                </li>\r\n            </ul>\r\n        </ul>\r\n    </nz-col>\r\n    <nz-col [nzLg]="24" [nzXl]="19" *ngIf="selectedSettingData">\r\n        <fs-ng-alain-setting-management-main [providerName]="providerName" [providerKey]="providerKey" [settingGroups]="settingGroups" [(visible)]="visible" [rawData]="selectedSettingData"></fs-ng-alain-setting-management-main>\r\n    </nz-col>\r\n</nz-row>\r\n',styles:[""]}),y("design:paramtypes",[s.Store,g.NotifyService,l.ThemeCoreStateService])],e.ɵe),e.ɵd=function(){function e(){}return e.prototype.ngOnInit=function(){},e}(),e.ɵd=f([t.Component({selector:"fs-layout",template:"<fs-page-bar></fs-page-bar>\r\n\r\n<router-outlet></router-outlet>\r\n\r\n\r\n",styles:[""]}),y("design:paramtypes",[])],e.ɵd);var S,z=[{path:"",component:e.ɵd,children:[{path:"",component:e.ɵe}]}];e.ɵf=function(){},e.ɵf=f([t.NgModule({imports:[o.RouterModule.forChild(z)],exports:[o.RouterModule]})],e.ɵf),e.ɵc=S=function(){function e(){}return e.forChild=function(){return{ngModule:S,providers:[]}},e.forLazy=function(){return new i.LazyModuleFactory(S.forChild())},e.forEarly=function(){return new i.LazyModuleFactory(S.forChild())},e}(),e.ɵc=S=f([t.NgModule({declarations:[e.ɵd,e.ɵe],imports:[e.SharedModule,e.ɵf]})],e.ɵc);var D,N=e.ɵc.forEarly,M=[{path:"",component:i.DynamicLayoutComponent,canActivate:[i.AuthGuard,i.PermissionGuard],children:[{path:"settings",loadChildren:N}]}];e.ɵb=function(){},e.ɵb=f([t.NgModule({imports:[o.RouterModule.forChild(M)],exports:[o.RouterModule]})],e.ɵb),e.SettingManagementNgAlainModule=D=function(){function e(){}return e.forChild=function(){return{ngModule:D,providers:[]}},e.forLazy=function(){return new i.LazyModuleFactory(D.forChild())},e}(),e.SettingManagementNgAlainModule=D=f([t.NgModule({imports:[e.SharedModule,i.CoreModule,n.NgAlainBasicModule,h.SettingManagementModule,e.ɵb],exports:[e.SharedModule]})],e.SettingManagementNgAlainModule),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=fs-setting-management-ng-alain.umd.min.js.map