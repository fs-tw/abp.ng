{"version":3,"file":"fs-account-ng-alain.js","sources":["../../../../libs/account/ng-alain/src/lib/service/login.service.ts","../../../../libs/account/ng-alain/src/lib/components/login/login.component.ts","../../../../libs/account/ng-alain/src/lib/components/register/register.component.ts","../../../../libs/account/ng-alain/src/lib/components/manage-profile/manage-profile.component.ts","../../../../libs/account/ng-alain/src/lib/components/personal-settings/personal-settings.component.ts","../../../../libs/account/ng-alain/src/lib/components/change-password/change-password.component.ts","../../../../libs/account/ng-alain/src/lib/components/auth-wrapper/auth-wrapper.component.ts","../../../../libs/account/ng-alain/src/lib/components/tenant-box/tenant-box.component.ts","../../../../libs/account/ng-alain/src/lib/account-ng-alain.module.ts","../../../../libs/account/ng-alain/src/fs-account-ng-alain.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { RestService, PagedResultDto, SessionState } from '@abp/ng.core';\r\nimport { Store } from '@ngxs/store';\r\nexport class LoginDto {\r\n  userNameOrEmailAddress: string;\r\n  password: string;\r\n  rememberClient: boolean;\r\n  //tenanId: string;\r\n}\r\n\r\n\r\n@Injectable()\r\nexport class LoginService {\r\n\r\n  constructor(\r\n    private restService: RestService,\r\n    private store: Store,\r\n  ) {\r\n\r\n  }\r\n\r\n\r\n  login(body: LoginDto) {\r\n    const tenant = this.store.selectSnapshot(SessionState.getTenant);\r\n    return this.restService.request(\r\n      {\r\n        url: '/api/token/authenticate',\r\n        method: 'POST',\r\n        body,\r\n        headers: { ...(tenant && tenant.id && { __tenant: tenant.id }) }\r\n      });\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n// {\r\n//   \"userNameOrEmailAddress\": \"string\",\r\n//   \"password\": \"string\",\r\n//   \"rememberClient\": true,\r\n//   \"tenanId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\"\r\n// }","import { LoginComponent, Options } from '@abp/ng.account';\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { Component, Inject, Optional } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport { Store } from '@ngxs/store';\r\nimport { OAuthService } from 'angular-oauth2-oidc';\r\nimport { AuthService, SetRemember, GetAppConfiguration } from '@abp/ng.core';\r\nimport { LoginService, LoginDto } from '../../service/login.service'\r\nimport { Navigate, RouterState } from '@ngxs/router-plugin';\r\nimport { catchError, finalize, tap } from 'rxjs/operators';\r\nimport snq from 'snq';\r\nimport { throwError } from 'rxjs';\r\n@Component({\r\n    selector: 'ng-alain-login',\r\n    templateUrl: './login.component.html',\r\n    styleUrls: ['./login.component.less']\r\n})\r\nexport class UserLoginComponent extends LoginComponent {\r\n\r\n    constructor(\r\n        protected loginService: LoginService,\r\n        @Optional() @Inject('ACCOUNT_OPTIONS') private options: any,\r\n        _fb: FormBuilder,\r\n        _oauthService: OAuthService,\r\n        protected _store: Store,\r\n        protected _toasterService: ToasterService,\r\n        _authService: AuthService\r\n    ) {\r\n        super(_fb, _oauthService, _store, _toasterService, _authService);\r\n    }\r\n\r\n    // override\r\n    // onSubmit() {\r\n    //     alert(\"override\")\r\n    //     if (this.form.invalid) return;\r\n\r\n    //     let input: LoginDto = {\r\n    //         userNameOrEmailAddress: this.form.get('username').value,\r\n    //         password: this.form.get('password').value,\r\n    //         rememberClient: false\r\n    //     }\r\n    //     this.inProgress = true;\r\n    //     this.loginService.login(input).pipe(\r\n    //         catchError(err => {\r\n    //             this._toasterService.error(\r\n    //                 snq(() => err.error.error_description) ||\r\n    //                 snq(() => err.error.error.message, 'AbpAccount::DefaultErrorMessage'),\r\n    //                 'Error',\r\n    //                 { life: 7000 },\r\n    //             );\r\n    //             return throwError(err);\r\n    //         }),\r\n    //         finalize(() => (this.inProgress = false)),\r\n    //     ).subscribe((x: any) => {\r\n    //         localStorage.setItem('access_token', x.token.accessToken);\r\n    //         this._store.dispatch(new SetRemember(this.form.get('remember').value));\r\n    //         this._store.dispatch(new GetAppConfiguration())\r\n    //         const redirectUrl =\r\n    //             snq(() => window.history.state.redirectUrl) || (this.options || {}).redirectUrl || '/';\r\n    //         this._store.dispatch(new Navigate([redirectUrl]));\r\n    //     })\r\n    // }\r\n}\r\n","import { Component, OnDestroy } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { FormGroup, FormBuilder, Validators, FormControl } from '@angular/forms';\r\nimport { NzMessageService } from 'ng-zorro-antd';\r\nimport { _HttpClient } from '@delon/theme';\r\nimport { RegisterComponent } from '@abp/ng.account';\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { AccountService } from '@abp/ng.account';\r\nimport { OAuthService } from 'angular-oauth2-oidc';\r\nimport { Store } from '@ngxs/store';\r\nimport { AuthService } from '@abp/ng.core';\r\n\r\n@Component({\r\n  selector: 'fs-register',\r\n  templateUrl: './register.component.html',\r\n  styleUrls: ['./register.component.less'],\r\n})\r\nexport class UserRegisterComponent extends RegisterComponent {\r\n    constructor(\r\n        private _fb: FormBuilder,\r\n        private _accountService: AccountService,\r\n        private _oauthService: OAuthService,\r\n        private _store: Store,\r\n        private _toasterService: ToasterService,\r\n        private _authService: AuthService,\r\n    ) {\r\n        super(_fb, _accountService, _oauthService, _store,_toasterService,_authService);\r\n  }\r\n}\r\n","import { fadeIn } from '@abp/ng.theme.shared';\r\nimport { transition, trigger, useAnimation } from '@angular/animations';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'ng-alain-manage-profile',\r\n    templateUrl: './manage-profile.component.html',\r\n    styleUrls: ['./manage-profile.component.less'],\r\n    animations: [trigger('fadeIn', [transition(':enter', useAnimation(fadeIn))])],\r\n})\r\nexport class ManageProfileComponent {\r\n    selectedTab = 0;\r\n}\r\n","import { PersonalSettingsComponent as AbpPersonalSettingsComponent } from '@abp/ng.account';\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { Store } from '@ngxs/store';\r\n@Component({\r\n    selector: 'ng-alain-personal-settings-form',\r\n    templateUrl: './personal-settings.component.html',\r\n    styleUrls: ['./personal-settings.component.less']\r\n})\r\nexport class PersonalSettingsComponent extends AbpPersonalSettingsComponent implements OnInit {\r\n\r\n    constructor(private _fb: FormBuilder, private _store: Store, private _toasterService: ToasterService) {\r\n        super(_fb, _store, _toasterService);\r\n    }\r\n\r\n}\r\n","import { ChangePasswordComponent as AbpChangePasswordComponent } from '@abp/ng.account';\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { Store } from '@ngxs/store';\r\n\r\n@Component({\r\n    selector: 'ng-alain-change-password-form',\r\n    templateUrl: './change-password.component.html',\r\n    styleUrls: ['./change-password.component.less']\r\n})\r\nexport class ChangePasswordComponent extends AbpChangePasswordComponent implements OnInit {\r\n\r\n    constructor(private _fb: FormBuilder, private _store: Store, private _toasterService: ToasterService) {\r\n        super(_fb, _store, _toasterService);\r\n    }\r\n\r\n}\r\n","import { Component, Input, TemplateRef, OnInit, Inject } from '@angular/core';\r\nimport { Account } from '@abp/ng.account';\r\nimport { ReplaceableComponents } from '@abp/ng.core';\r\n\r\n@Component({\r\n  selector: 'ng-alain-auth-wrapper',\r\n  templateUrl: './auth-wrapper.component.html',\r\n})\r\nexport class AuthWrapperComponent\r\n  implements Account.AuthWrapperComponentInputs, Account.AuthWrapperComponentOutputs {\r\n  @Input()\r\n  readonly mainContentRef: TemplateRef<any>;\r\n\r\n  @Input()\r\n  readonly cancelContentRef: TemplateRef<any>;\r\n}\r\n","import { ABP, SetTenant, SessionState, ConfigState } from '@abp/ng.core';\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { Component, OnInit, TemplateRef, Input } from '@angular/core';\r\nimport { Store ,Select} from '@ngxs/store';\r\nimport { throwError, Observable } from 'rxjs';\r\n\r\nimport { AccountService } from '@abp/ng.account';\r\nimport { TenantBoxComponent as AbpTenantBoxComponent,Account} from '@abp/ng.account';\r\n\r\n@Component({\r\n  selector: 'ng-alain-tenant-box',\r\n  templateUrl: './tenant-box.component.html'\r\n})\r\nexport class TenantBoxComponent \r\n  extends AbpTenantBoxComponent \r\n  implements Account.TenantBoxComponentInputs, Account.TenantBoxComponentOutputs {\r\n  @Input()\r\n  mainContentRef: TemplateRef<any>;\r\n\r\n  @Select(ConfigState.getDeep('multiTenancy.isEnabled'))\r\n  isMultiTenancyEnabled$: Observable<boolean>;\r\n  constructor(\r\n    private _store: Store,\r\n    private _toasterService: ToasterService,\r\n    private _accountService: AccountService\r\n  ) {\r\n    super(_store, _toasterService, _accountService);\r\n  }\r\n\r\n\r\n}\r\n","import { CoreModule, AddReplaceableComponent, eLayoutType, LazyModuleFactory } from '@abp/ng.core';\r\nimport { NgModule, ModuleWithProviders, NgModuleFactory } from '@angular/core';\r\nimport { NgAlainBasicModule } from '@fs/ng-alain/basic';\r\nimport { UserLoginComponent } from './components/login/login.component';\r\nimport { UserRegisterComponent } from './components/register/register.component';\r\nimport { ManageProfileComponent } from './components/manage-profile/manage-profile.component';\r\nimport { PersonalSettingsComponent } from './components/personal-settings/personal-settings.component';\r\nimport { ChangePasswordComponent } from './components/change-password/change-password.component';\r\nimport { AuthWrapperComponent } from './components/auth-wrapper/auth-wrapper.component';\r\nimport { TenantBoxComponent } from './components/tenant-box/tenant-box.component';\r\nimport { Options, ACCOUNT_OPTIONS, AuthenticationFlowGuard } from '@abp/ng.account';\r\nimport { AccountModule } from '@abp/ng.account';\r\nimport { NgxValidateCoreModule } from '@ngx-validate/core';\r\nimport { LoginService } from './service/login.service';\r\nexport function accountOptionsFactory(options: Options) {\r\n  return {\r\n    redirectUrl: '/',\r\n    ...options,\r\n  };\r\n}\r\n\r\n@NgModule({\r\n  imports: [\r\n    CoreModule,\r\n    NgAlainBasicModule,\r\n    NgxValidateCoreModule,\r\n    AccountModule\r\n  ],\r\n  declarations: [\r\n    AuthWrapperComponent,\r\n    TenantBoxComponent,\r\n    UserLoginComponent,\r\n    UserRegisterComponent,\r\n    ManageProfileComponent,\r\n    PersonalSettingsComponent,\r\n    ChangePasswordComponent\r\n  ],\r\n  entryComponents: [\r\n    UserLoginComponent,\r\n    UserRegisterComponent,\r\n    ManageProfileComponent\r\n  ],\r\n  providers: [\r\n    LoginService\r\n  ]\r\n})\r\nexport class AccountNgAlainModule {\r\n  static forChild(options): ModuleWithProviders<AccountNgAlainModule> {\r\n    return {\r\n      ngModule: AccountNgAlainModule,\r\n      providers: [\r\n        AuthenticationFlowGuard,\r\n        { provide: ACCOUNT_OPTIONS, useValue: options },\r\n        {\r\n          provide: 'ACCOUNT_OPTIONS',\r\n          useFactory: accountOptionsFactory,\r\n          deps: [ACCOUNT_OPTIONS],\r\n        },\r\n      ],\r\n    };\r\n  }\r\n  static forLazy(options: Options): NgModuleFactory<AccountNgAlainModule> {\r\n    return new LazyModuleFactory(AccountNgAlainModule.forChild(options));\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {AuthWrapperComponent as ɵa} from './lib/components/auth-wrapper/auth-wrapper.component';\nexport {ChangePasswordComponent as ɵe} from './lib/components/change-password/change-password.component';\nexport {PersonalSettingsComponent as ɵd} from './lib/components/personal-settings/personal-settings.component';\nexport {TenantBoxComponent as ɵb} from './lib/components/tenant-box/tenant-box.component';\nexport {LoginService as ɵc} from './lib/service/login.service';"],"names":["AbpPersonalSettingsComponent","AbpChangePasswordComponent","AbpTenantBoxComponent"],"mappings":";;;;;;;;;;;;;MAGa,QAAQ;CAKpB;IAIY,YAAY,GAAzB,MAAa,YAAY;IAEvB,YACU,WAAwB,EACxB,KAAY;QADZ,gBAAW,GAAX,WAAW,CAAa;QACxB,UAAK,GAAL,KAAK,CAAO;KAGrB;IAGD,KAAK,CAAC,IAAc;QAClB,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;QACjE,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAC7B;YACE,GAAG,EAAE,yBAAyB;YAC9B,MAAM,EAAE,MAAM;YACd,IAAI;YACJ,OAAO,qBAAQ,MAAM,IAAI,MAAM,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,CAAC,EAAE,EAAE,EAAG;SACjE,CAAC,CAAC;KACN;EAEF;AArBY,YAAY;IADxB,UAAU,EAAE;qCAIY,WAAW;QACjB,KAAK;GAJX,YAAY,CAqBxB;AAKD;AACA;AACA;AACA;AACA;AACA;;IC1Ba,kBAAkB,GAA/B,MAAa,kBAAmB,SAAQ,cAAc;IAElD,YACc,YAA0B,EACW,OAAY,EAC3D,GAAgB,EAChB,aAA2B,EACjB,MAAa,EACb,eAA+B,EACzC,YAAyB;QAEzB,KAAK,CAAC,GAAG,EAAE,aAAa,EAAE,MAAM,EAAE,eAAe,EAAE,YAAY,CAAC,CAAC;QARvD,iBAAY,GAAZ,YAAY,CAAc;QACW,YAAO,GAAP,OAAO,CAAK;QAGjD,WAAM,GAAN,MAAM,CAAO;QACb,oBAAe,GAAf,eAAe,CAAgB;KAI5C;EAiCJ;AA7CY,kBAAkB;IAL9B,SAAS,CAAC;QACP,QAAQ,EAAE,gBAAgB;QAC1B,m5DAAqC;;KAExC,CAAC;IAKO,WAAA,QAAQ,EAAE,CAAA,EAAE,WAAA,MAAM,CAAC,iBAAiB,CAAC,CAAA;qCADd,YAAY,UAE/B,WAAW;QACD,YAAY;QACT,KAAK;QACI,cAAc;QAC3B,WAAW;GATpB,kBAAkB,CA6C9B;;IC7CY,qBAAqB,GAAlC,MAAa,qBAAsB,SAAQ,iBAAiB;IACxD,YACY,GAAgB,EAChB,eAA+B,EAC/B,aAA2B,EAC3B,MAAa,EACb,eAA+B,EAC/B,YAAyB;QAEjC,KAAK,CAAC,GAAG,EAAE,eAAe,EAAE,aAAa,EAAE,MAAM,EAAC,eAAe,EAAC,YAAY,CAAC,CAAC;QAPxE,QAAG,GAAH,GAAG,CAAa;QAChB,oBAAe,GAAf,eAAe,CAAgB;QAC/B,kBAAa,GAAb,aAAa,CAAc;QAC3B,WAAM,GAAN,MAAM,CAAO;QACb,oBAAe,GAAf,eAAe,CAAgB;QAC/B,iBAAY,GAAZ,YAAY,CAAa;KAGtC;EACF;AAXY,qBAAqB;IALjC,SAAS,CAAC;QACT,QAAQ,EAAE,aAAa;QACvB,4lDAAwC;;KAEzC,CAAC;qCAGmB,WAAW;QACC,cAAc;QAChB,YAAY;QACnB,KAAK;QACI,cAAc;QACjB,WAAW;GAP5B,qBAAqB,CAWjC;;IClBY,sBAAsB,GAAnC,MAAa,sBAAsB;IAAnC;QACI,gBAAW,GAAG,CAAC,CAAC;KACnB;EAAA;AAFY,sBAAsB;IANlC,SAAS,CAAC;QACP,QAAQ,EAAE,yBAAyB;QACnC,ugCAA8C;QAE9C,UAAU,EAAE,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,QAAQ,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;;KAChF,CAAC;GACW,sBAAsB,CAElC;;ICFY,yBAAyB,GAAtC,MAAa,yBAA0B,SAAQA,2BAA4B;IAEvE,YAAoB,GAAgB,EAAU,MAAa,EAAU,eAA+B;QAChG,KAAK,CAAC,GAAG,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;QADpB,QAAG,GAAH,GAAG,CAAa;QAAU,WAAM,GAAN,MAAM,CAAO;QAAU,oBAAe,GAAf,eAAe,CAAgB;KAEnG;EAEJ;AANY,yBAAyB;IALrC,SAAS,CAAC;QACP,QAAQ,EAAE,iCAAiC;QAC3C,oqDAAiD;;KAEpD,CAAC;qCAG2B,WAAW,EAAkB,KAAK,EAA2B,cAAc;GAF3F,yBAAyB,CAMrC;;ICLY,uBAAuB,GAApC,MAAa,uBAAwB,SAAQC,yBAA0B;IAEnE,YAAoB,GAAgB,EAAU,MAAa,EAAU,eAA+B;QAChG,KAAK,CAAC,GAAG,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;QADpB,QAAG,GAAH,GAAG,CAAa;QAAU,WAAM,GAAN,MAAM,CAAO;QAAU,oBAAe,GAAf,eAAe,CAAgB;KAEnG;EAEJ;AANY,uBAAuB;IALnC,SAAS,CAAC;QACP,QAAQ,EAAE,+BAA+B;QACzC,u/CAA+C;;KAElD,CAAC;qCAG2B,WAAW,EAAkB,KAAK,EAA2B,cAAc;GAF3F,uBAAuB,CAMnC;;ICTY,oBAAoB,GAAjC,MAAa,oBAAoB;EAOhC;AAJC;IADC,KAAK,EAAE;8BACiB,WAAW;4DAAM;AAG1C;IADC,KAAK,EAAE;8BACmB,WAAW;8DAAM;AANjC,oBAAoB;IAJhC,SAAS,CAAC;QACT,QAAQ,EAAE,uBAAuB;QACjC,2KAA4C;KAC7C,CAAC;GACW,oBAAoB,CAOhC;;ICFY,kBAAkB,GAA/B,MAAa,kBACX,SAAQC,oBAAqB;IAO7B,YACU,MAAa,EACb,eAA+B,EAC/B,eAA+B;QAEvC,KAAK,CAAC,MAAM,EAAE,eAAe,EAAE,eAAe,CAAC,CAAC;QAJxC,WAAM,GAAN,MAAM,CAAO;QACb,oBAAe,GAAf,eAAe,CAAgB;QAC/B,oBAAe,GAAf,eAAe,CAAgB;KAGxC;EAGF;AAbC;IADC,KAAK,EAAE;8BACQ,WAAW;0DAAM;AAGjC;IADC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC;8BAC9B,UAAU;kEAAU;AAPjC,kBAAkB;IAJ9B,SAAS,CAAC;QACT,QAAQ,EAAE,qBAAqB;QAC/B,krEAA0C;KAC3C,CAAC;qCAUkB,KAAK;QACI,cAAc;QACd,cAAc;GAX9B,kBAAkB,CAiB9B;;;SChBe,qBAAqB,CAAC,OAAgB;IACpD,uBACE,WAAW,EAAE,GAAG,IACb,OAAO,EACV;AACJ,CAAC;IA2BY,oBAAoB,4BAAjC,MAAa,oBAAoB;IAC/B,OAAO,QAAQ,CAAC,OAAO;QACrB,OAAO;YACL,QAAQ,EAAE,sBAAoB;YAC9B,SAAS,EAAE;gBACT,uBAAuB;gBACvB,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,OAAO,EAAE;gBAC/C;oBACE,OAAO,EAAE,iBAAiB;oBAC1B,UAAU,EAAE,qBAAqB;oBACjC,IAAI,EAAE,CAAC,eAAe,CAAC;iBACxB;aACF;SACF,CAAC;KACH;IACD,OAAO,OAAO,CAAC,OAAgB;QAC7B,OAAO,IAAI,iBAAiB,CAAC,sBAAoB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;KACtE;EACF;AAlBY,oBAAoB;IAzBhC,QAAQ,CAAC;QACR,OAAO,EAAE;YACP,UAAU;YACV,kBAAkB;YAClB,qBAAqB;YACrB,aAAa;SACd;QACD,YAAY,EAAE;YACZ,oBAAoB;YACpB,kBAAkB;YAClB,kBAAkB;YAClB,qBAAqB;YACrB,sBAAsB;YACtB,yBAAyB;YACzB,uBAAuB;SACxB;QACD,eAAe,EAAE;YACf,kBAAkB;YAClB,qBAAqB;YACrB,sBAAsB;SACvB;QACD,SAAS,EAAE;YACT,YAAY;SACb;KACF,CAAC;GACW,oBAAoB,CAkBhC;;AChED;;;;;;"}